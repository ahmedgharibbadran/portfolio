<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Ahmed Gharib - Data Analyst Portfolio. Helping businesses turn complex data into strategic insights using Power BI, Excel, and SQL.">
    <meta name="keywords" content="Data Analyst, Power BI, Ahmed Gharib, AGBINSIGHTS, Data Visualization, SQL, Portfolio, Business Intelligence">
    
    <title>Ahmed Gharib | AGBINSIGHTS</title>
   <link rel="icon" type="image/svg+xml" href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y="75" font-size="70" fill="%230056b3" font-family="Arial Black">A</text><path d="M5 85 L40 45 L95 10" stroke="%230056b3" stroke-width="12" fill="none" stroke-linecap="round"/></svg>'>
    <style>
        :root { 
            --main-blue: #0056b3; 
            --bg-white: #ffffff; /* الموقع هيفضل أبيض سادة */
            --nav-bg: #f9f9f9;  /* لون خلفية اللوجو المخصوص للهيدر */
            --deep-black: #000000;
            --text-gray: #555555; 
            --glow-effect: 0 4px 15px rgba(0, 86, 179, 0.2);
            --footer-black: transparent; 
        }
        body { background-color: var(--bg-white); color: var(--deep-black); font-family: 'Inter', sans-serif; margin: 0; text-align: center; scroll-behavior: smooth; overflow-x: hidden; }
        body.rtl { direction: rtl; font-family: 'Cairo', sans-serif; }
        
        #welcome-overlay { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: var(--bg-white);
            display: flex; align-items: center; justify-content: center; 
            z-index: 10000; transition: 1s cubic-bezier(0.85, 0, 0.15, 1); 
        }        
        #welcome-overlay.slide-up {
            transform: translateY(-100%);
        }
        .welcome-box { text-align: center; padding: 20px; }
        .welcome-logo { width: 120px; height: 120px; margin-bottom: 25px; border-radius: 50%; border: 3px solid var(--main-blue); transition: 0.3s; object-fit: contain; }        
        .start-btn { 
            background: var(--main-blue); color: white; padding: 15px 40px; 
            border: none; border-radius: 50px; font-weight: 900; cursor: pointer; 
            margin-top: 30px; text-transform: uppercase; letter-spacing: 2px;
        }
        #main-site { opacity: 0; display: none; }        
        nav { 
            width: 100%; 
            padding: 10px 5%; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.03); 
            background: var(--nav-bg); 
            position: sticky; 
            top: 0; 
            z-index: 1000;
            box-sizing: border-box;
            direction: ltr !important;
        }
        .nav-brand { display: flex; align-items: center; gap: 10px; }
        .nav-logo-img { height: 80px; width: auto; transition: 0.4s ease; cursor: pointer; mix-blend-mode: normal; }
        .nav-logo-img:hover { transform: scale(1.1); }
        
        body.dark-theme .nav-logo-img, body.dark-theme .welcome-logo { 
            mix-blend-mode: normal; filter: none; 
        }

        /* تعديلات اللغات والسيرة الذاتية */
        .lang-switch { display: flex; gap: 15px; align-items: center; }
        
        .lang-dropdown { position: relative; display: inline-block; cursor: pointer; padding: 8px 12px; background: rgba(0, 86, 179, 0.05); border-radius: 8px; transition: 0.3s; }
        .lang-trigger { display: flex; align-items: center; gap: 8px; font-weight: 700; color: var(--main-blue); font-size: 14px; }
        .lang-trigger svg { width: 12px; height: 12px; transition: 0.3s; fill: var(--main-blue); }
        .lang-dropdown:hover .lang-trigger svg { transform: rotate(180deg); }
        .lang-menu { position: absolute; top: 110%; right: 0; background: var(--bg-white); box-shadow: 0 10px 25px rgba(0,0,0,0.1); border-radius: 12px; display: none; min-width: 140px; z-index: 1000; padding: 10px 0; border: 1px solid #eee; }
        .lang-dropdown:hover .lang-menu { display: block; }
        .lang-item { display: flex; align-items: center; gap: 10px; padding: 10px 20px; transition: 0.2s; color: var(--deep-black); text-decoration: none; font-size: 14px; }
        .lang-item:hover { background: var(--nav-bg); color: var(--main-blue); }
        .lang-item img { width: 20px; border-radius: 2px; }

        /* تم إخفاء الـ CV كما طلبت مع الحفاظ على الترتيب */
        .cv-header-btn { display: none !important; }

        #dark-mode-toggle {
            cursor: pointer;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: 0.3s;
        }
        #dark-mode-toggle svg, .card-3d svg, .process-step svg, .social-icons svg, .why-icon svg {
            width: 30px;
            height: 30px;
            fill: var(--main-blue);
            transition: all 0.3s ease;
        }
        
        .social-icons svg { width: 35px; height: 35px; fill: var(--deep-black); }
        .social-icons a:hover svg { fill: var(--main-blue); transform: translateY(-3px); }

        .flag-btn { 
            width: 32px !important; 
            height: 32px !important; 
            cursor: pointer; 
            border-radius: 50% !important; 
            opacity: 0.8; 
            transition: 0.3s; 
            object-fit: cover !important; 
            border: 2px solid transparent !important;
        }
        .flag-btn.active { 
            opacity: 1 !important; 
            border: 2px solid var(--main-blue) !important; 
            transform: scale(1.15);
        }
        header { padding: 60px 20px; text-align: center; }
        h1 { font-size: clamp(35px, 8vw, 75px); margin: 0; font-weight: 900; }        
        .job-tag { 
            color: var(--main-blue); 
            font-size: 16px; 
            letter-spacing: 3px; 
            font-weight: 700; 
            text-transform: uppercase; 
            display: inline-block; 
            margin-top: 10px; 
            min-height: 1.2em;
        }
        .job-tag::after { content: "|"; animation: blink 0.7s infinite; }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }
        .about-text { 
            max-width: 800px; 
            margin: 25px auto; 
            color: var(--text-gray); 
            font-size: 17px; 
            line-height: 1.6; 
            padding: 0 20px;
            border-left: 3px solid var(--main-blue);
        }
        body.rtl .about-text { border-left: none; border-right: 3px solid var(--main-blue); }
        .section-title { 
            text-align: left; margin: 40px 0 20px 10%; color: var(--deep-black); 
            border-left: 5px solid var(--main-blue); padding-left: 15px; 
            font-weight: bold; font-size: 24px;
        }
        body.rtl .section-title { text-align: right; border-left: none; border-right: 5px solid var(--main-blue); padding-left: 0; padding-right: 15px; margin: 40px 10% 20px 0; }

        /* Why Me Section Style */
        .why-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            padding: 0 10%;
            margin-bottom: 50px;
        }
        .why-card {
            background: var(--bg-white);
            border: 1px solid #eee;
            padding: 30px;
            border-radius: 20px;
            transition: 0.3s ease;
            text-align: center;
        }
        .why-card:hover {
            transform: translateY(-10px);
            box-shadow: var(--glow-effect);
            border-color: var(--main-blue);
        }
        .why-icon {
            margin-bottom: 20px;
        }
        .why-card h3 {
            color: var(--main-blue);
            margin-bottom: 15px;
        }
        .why-card p {
            color: var(--text-gray);
            font-size: 15px;
            line-height: 1.6;
        }
        .grid-container, .process-flow { 
            display: flex; 
            justify-content: center; 
            gap: 15px; 
            flex-wrap: wrap; 
            padding: 0 10%; 
            margin-bottom: 40px; 
        }
        .card-3d, .process-step { 
            background: var(--bg-white); 
            border: 1px solid #eee; 
            padding: 25px 15px; 
            flex: 1 1 130px; 
            max-width: 200px;
            border-radius: 15px; 
            transition: all 0.3s ease; 
            cursor: pointer; 
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* --- تعديل وضع الموبايل (الجزء المطلوب) --- */
        @media (max-width: 768px) {
            nav { padding: 10px 3%; }
            .nav-logo-img { height: 60px; }
            .lang-switch { gap: 8px; }
            
            .why-container, .grid-container, .process-flow, .projects-wrapper { 
                padding: 0 5% !important; 
                display: flex !important;
                flex-direction: column !important;
                align-items: center !important;
                gap: 20px !important;
            }
            .why-card, .card-3d, .process-step, .project-item { 
                width: 90% !important; 
                max-width: 400px !important; 
                flex: none !important;
            }
            .section-title { 
                margin: 30px 5% 15px 5% !important; 
                font-size: 20px !important;
            }
            .about-text { font-size: 15px; }
            h1 { font-size: 40px; }
        }

        .card-3d svg, .process-step svg {
            margin-bottom: 15px;
            opacity: 0.7;
        }
        .card-3d:hover svg, .process-step:hover svg {
            opacity: 1;
            transform: scale(1.1);
        }
        .projects-wrapper { 
            display: flex; 
            flex-direction: column; 
            gap: 40px; 
            padding: 0 10%; 
        }
        .project-item { 
            display: flex; 
            flex-direction: column; 
            background: var(--bg-white); 
            border: 1px solid #eee; 
            border-radius: 20px; 
            overflow: hidden; 
            width: 100%; 
        }
        .p-img { width: 100%; line-height: 0; }
        .p-img img { width: 100%; height: auto; display: block; object-fit: cover; }
        .p-text { width: 100%; padding: 30px; box-sizing: border-box; text-align: center; }

        @media (min-width: 768px) {
            .why-container { grid-template-columns: repeat(3, 1fr) !important; }
            .project-item { flex-direction: row; align-items: stretch; }
            .p-img { width: 60%; } 
            .p-text { width: 40%; padding: 40px; display: flex; flex-direction: column; justify-content: center; text-align: left; }
            body.rtl .p-text { text-align: right; }
        }
        .btn-view { border: 2px solid var(--main-blue); color: var(--main-blue); padding: 12px 30px; border-radius: 10px; cursor: pointer; display: inline-block; margin-top: 20px; font-weight: 800; transition: 0.3s; }
        .btn-view:hover { background: var(--main-blue); color: #fff; }        
        #case-study-view { display:none; background: var(--bg-white); padding: 40px 10%; text-align: left; }
        body.rtl #case-study-view { text-align: right; }
        .case-header { background: #f9f9f9; padding: 30px; border-radius: 20px; border-left: 6px solid var(--main-blue); margin-bottom: 30px; }
        body.rtl .case-header { border-left: none; border-right: 6px solid var(--main-blue); }
        .detail-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px; }
        .rating-input-section { margin-bottom: 30px; padding: 30px; background: #f9f9f9; border-radius: 20px; text-align: center; }
        .stars { font-size: 24px; margin-bottom: 10px; cursor: pointer; color: #ccc; }
        .stars .active { color: #ffce00; }
        .rating-input { width: 100%; max-width: 400px; padding: 12px; border: 1px solid #ddd; border-radius: 10px; margin-bottom: 10px; font-family: inherit; }
        .submit-rate-btn { background: var(--main-blue); color: white; border: none; padding: 10px 25px; border-radius: 8px; cursor: pointer; font-weight: bold; }

        footer { 
            padding: 60px 20px; 
            background: transparent; 
            color: var(--deep-black); 
            margin-top: 50px; 
            transition: 0.3s;
        }
        .social-icons a { color: inherit; margin: 0 15px; display: inline-block; transition: 0.3s; text-decoration: none; }

        body.dark-theme { --bg-white: #111111; --nav-bg: #000000; --deep-black: #ffffff; --text-gray: #bbbbbb; }
        body.dark-theme nav { background: var(--nav-bg); border-bottom: 1px solid #222; } 
        body.dark-theme .card-3d, body.dark-theme .process-step, body.dark-theme .project-item, body.dark-theme .case-header, body.dark-theme .rating-input-section, body.dark-theme .why-card { background: #000000; border-color: #222; }
        body.dark-theme .rating-input { background: #252525; color: white; border-color: #444; }

        /* زر العودة للأعلى */
        #back-to-top {
            position: fixed; bottom: 30px; right: 30px; width: 45px; height: 45px;
            background: var(--main-blue); color: white; border: none; border-radius: 50%;
            cursor: pointer; display: none; align-items: center; justify-content: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2); z-index: 2000; transition: 0.3s;
        }
        #back-to-top:hover { transform: scale(1.1); }

        .reveal { opacity: 0; transform: translateY(30px); transition: all 0.8s ease-out; }
        .reveal.active { opacity: 1; transform: translateY(0); }
        .agb-header-txt {
            fill: #000000;
            transition: fill 0.3s ease;
        }
        body.dark-theme .agb-header-txt {
            fill: #ffffff !important;
        }
        .nav-brand:hover .agb-header-txt {
            fill: var(--main-blue) !important;
        }                                     
    </style>
</head>
<body>
<div id="welcome-overlay">
    <div class="welcome-box">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 170 60" style="width: 140px; height: auto; margin-bottom: 20px; display: block; margin-left: auto; margin-right: auto;">
            <defs>
                <linearGradient id="welcomeGradient" x1="0%" y1="100%" x2="100%" y2="0%">
                    <stop offset="0%" style="stop-color:#0056b3; stop-opacity:0.2" />
                    <stop offset="100%" style="stop-color:#0056b3; stop-opacity:1" />
                </linearGradient>
            </defs>
            <text x="0" y="48" font-family="'Arial Black', sans-serif" font-size="44" font-weight="900" letter-spacing="-3" fill="#0056b3">AGB</text>
            <path d="M5 55 L45 55 L75 32 L115 38 L158 12" stroke="url(#welcomeGradient)" stroke-width="6" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M158 12 L145 15 L152 23 Z" fill="#0056b3" />
            <circle cx="75" cy="32" r="2.5" fill="#0056b3" fill-opacity="0.5" />
            <circle cx="115" cy="38" r="2.5" fill="#0056b3" fill-opacity="0.5" />
        </svg>

        <h2 id="welcome-name">Ahmed Gharib</h2>
        <p id="welcome-tagline">Turning Complex Data into Strategic Assets</p>
        <button class="start-btn" onclick="startExploring()" id="welcome-btn">Explore Insights</button>
    </div>
</div>

<button id="back-to-top" onclick="window.scrollTo(0,0)">
    <svg style="width:24px; height:24px; fill:white" viewBox="0 0 24 24"><path d="M7.41,15.41L12,10.83L16.59,15.41L18,14L12,8L6,14L7.41,15.41Z" /></svg>
</button>

<div id="main-site">
 <nav>
        <div class="nav-brand" onclick="location.reload()" style="cursor: pointer;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 170 60" style="width: 100px; height: auto; display: block;">
                <defs>
                    <linearGradient id="analystGradient" x1="0%" y1="100%" x2="100%" y2="0%">
                        <stop offset="0%" style="stop-color:#0056b3; stop-opacity:0.2" />
                        <stop offset="100%" style="stop-color:#0056b3; stop-opacity:1" />
                    </linearGradient>
                </defs>
                <text x="0" y="48" font-family="'Arial Black', sans-serif" font-size="44" font-weight="900" letter-spacing="-3" class="agb-header-txt">AGB</text>
                <path d="M5 55 L45 55 L75 32 L115 38 L158 12" stroke="url(#analystGradient)" stroke-width="6" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M158 12 L145 15 L152 23 Z" fill="#0056b3" />
                <circle cx="75" cy="32" r="2.5" fill="#0056b3" fill-opacity="0.5" />
                <circle cx="115" cy="38" r="2.5" fill="#0056b3" fill-opacity="0.5" />
            </svg>
        </div>
        <div class="lang-switch">
            <div class="lang-dropdown">
                <div class="lang-trigger">
                    <span id="lang-label">Languages</span>
                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                </div>
                <div class="lang-menu">
                    <a href="javascript:void(0)" class="lang-item" onclick="setLang('en')"><img src="https://flagcdn.com/w40/gb.png"> English</a>
                    <a href="javascript:void(0)" class="lang-item" onclick="setLang('ar')"><img src="https://flagcdn.com/w40/eg.png"> العربية</a>
                    <a href="javascript:void(0)" class="lang-item" onclick="setLang('es')"><img src="https://flagcdn.com/w40/es.png"> Español</a>
                </div>
            </div>
            <div id="dark-mode-toggle" onclick="toggleDarkMode()"></div>
        </div>
    </nav>
    <header>
        <h1 id="main-name">Ahmed Gharib</h1>
        <span class="job-tag" id="job-title"></span>
        <p class="about-text" id="about-me"></p>
    </header>
    <div class="section-title" id="title-why-me"></div>
    <div class="why-container">
        <div class="why-card reveal">
            <div class="why-icon"><svg viewBox="0 0 24 24"><path d="M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"/></svg></div>
            <h3 id="why1-t"></h3>
            <p id="why1-d"></p>
        </div>
        <div class="why-card reveal">
            <div class="why-icon"><svg viewBox="0 0 24 24"><path d="M21 7L9 19l-5.5-5.5 1.41-1.41L9 16.17 19.59 5.59 21 7z"/></svg></div>
            <h3 id="why2-t"></h3>
            <p id="why2-d"></p>
        </div>
        <div class="why-card reveal">
            <div class="why-icon"><svg viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg></div>
            <h3 id="why3-t"></h3>
            <p id="why3-d"></p>
        </div>
    </div>
    <div class="section-title" id="title-journey"></div>
    <div class="process-flow">
        <div class="process-step reveal" onclick="showJourney('understand')" style="cursor: pointer;">
            <svg viewBox="0 0 24 24"><path d="M12 2L4.5 20.29l.71.71L12 18l6.79 3 .71-.71z"/></svg>
            <h4 id="step1"></h4>
        </div>
        <div class="process-step reveal" onclick="showJourney('extract')" style="cursor: pointer;">
            <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"/></svg>
            <h4 id="step2"></h4>
        </div>
        <div class="process-step reveal" onclick="showJourney('clean')" style="cursor: pointer;">
            <svg viewBox="0 0 24 24"><path d="M14.79 10.62L3.5 21.91 2.09 20.5 13.38 9.21l1.41 1.41zm4.45-3.13l-1.41-1.41c-.78-.78-2.05-.78-2.83 0l-1.41 1.41 4.24 4.24 1.41-1.41c.78-.78.78-2.05 0-2.83z"/></svg>
            <h4 id="step3"></h4>
        </div>
        <div class="process-step reveal" onclick="showJourney('model')" style="cursor: pointer;">
            <svg viewBox="0 0 24 24"><path d="M15 9H9v6h6V9zm-2 4h-2v-2h2v2zm8-2V9h-2V7c0-1.1-.9-2-2-2h-2V3h-2v2h-2V3H9v2H7c-1.1 0-2 .9-2 2v2H3v2h2v2H3v2h2v2c0 1.1.9 2 2 2h2v2h2v-2h2v2h2v-2h2c1.1 0 2-.9 2-2v-2h2v-2h-2v-2h2zm-4 6H7V7h10v10z"/></svg>
            <h4 id="step4"></h4>
        </div>
        <div class="process-step reveal" onclick="showJourney('insight')" style="cursor: pointer;">
            <svg viewBox="0 0 24 24"><path d="M9 21c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-1H9v1zm3-19C8.14 2 5 5.14 5 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.86-3.14-7-7-7zm2.85 11.1l-.85.6V16h-4v-1.3l-.85-.6C7.8 13.15 7 11.18 7 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 2.18-.8 4.15-2.15 5.1z"/></svg>
            <h4 id="step5"></h4>
        </div>
    </div>
    <div class="section-title" id="title-expertise"></div>
    <div class="grid-container"> 
        <div class="card-3d reveal" onclick="showExpertise('powerbi')"><svg viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/></svg><span id="exp1">Power BI</span></div>
        <div class="card-3d reveal" onclick="showExpertise('excel')"><svg viewBox="0 0 24 24"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/></svg><span id="exp2">Excel</span></div>
        <div class="card-3d reveal" onclick="showExpertise('sql')"><svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"/></svg><span id="exp3">SQL</span></div>
        <div class="card-3d reveal" onclick="showExpertise('modeling')"><svg viewBox="0 0 24 24"><path d="M12 3L1 9l11 6 9-4.91V17h2V9L12 3z"/></svg><span id="skill3">Modeling</span></div>
        <div class="card-3d reveal" onclick="showExpertise('dax')"><svg viewBox="0 0 24 24"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg><span id="skill4"></span></div>
        <div class="card-3d reveal" onclick="showExpertise('etl')"><svg viewBox="0 0 24 24"><path d="M20 6h-8l-2-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm-6 10H6v-2h8v2zm4-4H6v-2h12v2z"/></svg><span id="exp4">ETL</span></div>
        <div class="card-3d reveal" onclick="showExpertise('viz')"><svg viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg><span id="skill6"></span></div>
    </div>
    <div class="section-title" id="title-projects"></div>
    <div class="projects-wrapper">
        <div class="project-item reveal"> 
            <div class="p-img"><img src="hr.png.png"></div>
            <div class="p-text">
                <h3 id="p1-title"></h3>
                <div class="btn-view" onclick="showStudy('hr')" id="p1-btn" style="cursor: pointer;"></div>
            </div>
        </div>
        <div class="project-item reveal">
            <div class="p-img"><img src="sales.png1.png"></div>
            <div class="p-text">
                <h3 id="p2-title"></h3>
                <div class="btn-view" onclick="showStudy('sales')" id="p2-btn" style="cursor: pointer;"></div>
            </div>
        </div>
        <div class="project-item reveal"> 
            <div class="p-img"><img src="Overviewpng1.png"></div>
            <div class="p-text">
                <h3 id="p3-title"></h3>
                <div class="btn-view" onclick="showStudy('furniture')" id="p3-btn" style="cursor: pointer;"></div>
            </div>
        </div>
    </div>
    <div class="section-title" id="title-ratings"></div>
    <div class="grid-container">
        <div class="card-3d reveal" onclick="openRatingsPage()" style="cursor: pointer; max-width: 250px;">
            <svg viewBox="0 0 24 24" style="fill: #ffce00; opacity: 1;"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
            <h4 id="view-ratings-text">View & Add Reviews</h4>
        </div>
    </div>
    <footer>
        <div class="social-icons">
            <a href="https://www.linkedin.com/in/ahmed-gharib-20989a272/" target="_blank" rel="noopener noreferrer">
                <svg viewBox="0 0 24 24"><path d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14m-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-2.79v8.37h2.79v-4.93c0-.77.62-1.4 1.39-1.4a1.4 1.4 0 0 1 1.4 1.4v4.93h2.79M6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69a1.69 1.69 0 0 0-1.69 1.69c0 .93.76 1.68 1.69 1.68m1.39 9.94v-8.37H5.5v8.37h2.77z"/></svg>
            </a>
            <a href="mailto:info@agbinsights.com">
                <svg viewBox="0 0 24 24"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg>
            </a>
        </div>
        <p style="margin-top: 10px; opacity: 0.6; font-size: 12px;">©️ AHMED GHARIB | AGBINSIGHTS</p>
    </footer>
</div>

<div id="case-study-view">
    <div onclick="hideStudy()" id="back-btn" style="color:var(--main-blue); cursor:pointer; margin-bottom:30px; font-weight:bold;"></div>
    <div id="case-header-content"></div>
    <div id="study-images"></div>
</div>
<script>
    let currentLang = localStorage.getItem('ahmedLang') || 'en';
    let isDarkMode = localStorage.getItem('ahmedDarkMode') === 'true';
    let lastScrollPos = 0;
    let selectedRating = 5;
    const SHEETDB_URL = 'https://sheetdb.io/api/v1/jv44e0ygedwit';
    const translations = {
        en: {
            name: "Ahmed Gharib", 
            welcomeBtn: "Explore Insights", 
            tagline: "Data Analyst | Business Intelligence & Insights",
            about: "I help organizations make sense of their data by converting complex datasets into simple, clear insights. Through data analysis and visualization, I support better decisions, performance improvement, and measurable business results.",
            journey: "Journey", 
            expertise: "Expertise", 
            projects: "Projects", 
            ratings: "Ratings",
            whyMe: "Why Choose Me?",
            why1t: "Business Driven", why1d: "I focus on delivering insights that directly impact ROI and decision-making.",
            why2t: "Clean Data First", why2d: "I ensure your data foundation is accurate and reliable before any analysis.",
            why3t: "Actionable Viz", why3d: "Complex data turned into intuitive, easy-to-understand visual stories.",
            step1: "Understand", step2: "Extract", step3: "Clean", step4: "Model", step5: "Insight",
            exp1: "Power BI", exp2: "Excel", exp3: "SQL", skill3: "Modeling", skill4: "DAX Logic", exp4: "ETL", skill6: "Viz",
            viewBtn: "View Details", back: "← BACK TO HOME",
            obj: "OBJECTIVE", ch: "CHALLENGE", sol: "SOLUTION", imp: "IMPACT", tool: "TOOLS",
            ratePrompt: "Leave a Review", namePlace: "Name", ratePlace: "Write your feedback...", rateBtn: "Submit",
            alert: "Please enter both name and comment", thanks: "Thank you for your feedback!",
            viewRatings: "View & Add Reviews", loading: "Loading reviews...",
            copyMsg: "Copied!", cv: "CV", lang: "Languages"
        },
        ar: {
            name: "أحمد غريب", 
            welcomeBtn: "استكشاف التفاصيل", 
            tagline: "تحويل البيانات المعقدة إلى رؤى استراتيجية",
            about: "أساعد المؤسسات على فهم بياناتها من خلال تحويل مجموعات البيانات المعقدة إلى رؤى بسيطة وواضحة. ومن خلال تحليل البيانات وتمثيلها بصرياً، أدعم اتخاذ قرارات أفضل، وتحسين الأداء، وتحقيق نتائج أعمال ملموسة.",
            journey: "الرحلة", 
            expertise: "الخبرات", 
            projects: "المشاريع", 
            ratings: "التقييمات",
            whyMe: "لماذا تختارني؟",
            why1t: "موجه للأعمال", why1d: "أركز على تقديم رؤى تؤثر بشكل مباشر على العائد على الاستثمار واتخاذ القرار.",
            why2t: "بيانات نظيفة أولاً", why2d: "أضمن أن أساس بياناتك دقيق وموثوق قبل البدء في أي تحليل.",
            why3t: "تصوير فعال", why3d: "تحويل البيانات المعقدة إلى قصص مرئية بديهية وسهلة الفهم.",
            step1: "الفهم", step2: "استخراج", step3: "تنظيف", step4: "نمذجة", step5: "رؤية",
            exp1: "باور بي آي", exp2: "إكسيل", exp3: "SQL", skill3: "النمذجة", skill4: "منطق DAX", exp4: "ETL", skill6: "التصوير",
            viewBtn: "عرض التفاصيل", back: "← العودة للرئيسية",
            obj: "الهدف", ch: "التحدي", sol: "الحل", imp: "الأثر", tool: "الأدوات",
            ratePrompt: "أضف تقييمك", namePlace: "الاسم", ratePlace: "اكتب رأيك هنا...", rateBtn: "إرسال",
            alert: "يرجى إدخال الاسم والتعليق", thanks: "شكراً لتقييمك!",
            viewRatings: "عرض وإضافة التقييمات", loading: "جاري تحميل التقييمات...",
            copyMsg: "تم النسخ!", cv: "السيرة الذاتية", lang: "اللغات"
        },
        es: {
            name: "Ahmed Gharib", 
            welcomeBtn: "Explorar Detalles", 
            tagline: "Convirtiendo Datos Complejos en Perspectivas Accionables",
            about: "Ayudo a las organizaciones a dar sentido a sus data convirtiendo conjuntos de data complejos en conocimientos sencillos y claros.",
            journey: "Trayectoria", 
            expertise: "Experiencia", 
            projects: "Proyectos", 
            ratings: "Valoraciones",
            whyMe: "¿Por qué elegirme?",
            why1t: "Impulsado por Negocios", why1d: "Me enfoco en entregar ideas que impacten directamente en el ROI.",
            why2t: "Datos Limpios Primero", why2d: "Aseguro que sus datos sean precisos y confiables antes de cualquier análisis.",
            why3t: "Visualización Accionable", why3d: "Datos complejos convertidos en historias visuales intuitivas.",
            step1: "Entender", step2: "Extraer", step3: "Limpiar", step4: "Modelar", step5: "Perspectiva",
            exp1: "Power BI", exp2: "Excel", exp3: "SQL", skill3: "Modelado", skill4: "DAX", exp4: "ETL", skill6: "Viz",
            viewBtn: "Ver Details", back: "← VOLVER AL INICIO",
            obj: "OBJETIVO", ch: "DESAFÍO", sol: "SOLUCIÓN", imp: "IMPACTO", tool: "HERRAMIENTAS",
            ratePrompt: "Deja una reseña", namePlace: "Nombre", ratePlace: "Escribe tu opinión...", rateBtn: "Enviar",
            alert: "Por favor, introduzca su nombre y commentario", thanks: "¡Gracias por tu comentario!",
            viewRatings: "Ver y añadir reseñas", loading: "Cargando reseñas...",
            copyMsg: "¡Copiado!", cv: "CV", lang: "Idiomas"
        }
    };
    const typingJobs = {
        en: ["Data Analyst", "Power BI Specialist", "Problem Solver", "Insights Explorer"],
        ar: ["محلل بيانات", "خبير Power BI", "محلل مشكلات", "مستكشف رؤى"],
        es: ["Analista de Datos", "Especialista en Power BI", "Analista de Problemas"]
    };
    let jobIdx = 0;
    let charIdx = 0;
    let isDeleting = false;

    function startTypingEffect() {
        const currentJobs = typingJobs[currentLang];
        const target = document.getElementById('job-title');
        if(!target) return;
        
        const fullText = currentJobs[jobIdx];       
        if (isDeleting) {
            target.innerText = fullText.substring(0, charIdx - 1);
            charIdx--;
        } else {
            target.innerText = fullText.substring(0, charIdx + 1);
            charIdx++;
        }
        let speed = isDeleting ? 50 : 150;
        if (!isDeleting && charIdx === fullText.length) {
            isDeleting = true;
            speed = 2000; 
        } else if (isDeleting && charIdx === 0) {
            isDeleting = false;
            jobIdx = (jobIdx + 1) % currentJobs.length;
            speed = 500;
        }
        setTimeout(startTypingEffect, speed);
    }
    const journeyData = {
        understand: {
            en: { title: "Understand Business Needs", desc: "Defining clear objectives and understanding the key performance indicators (KPIs) critical to the business success." },
            ar: { title: "فهم احتياجات العمل", desc: "تحديد أهداف واضحة وفهم مؤشرات الأداء الرئيسية (KPIs) الضرورية لنجاح الأعمال." },
            es: { title: "Entender el Negocio", desc: "Definición de objetivos claros y comprensión de los indicadores clave de rendimiento (KPI) críticos." }
        },
        extract: {
            en: { title: "Data Extraction", desc: "Connecting to various data sources to gather the raw information needed for analysis." },
            ar: { title: "استخراج البيانات", desc: "الاتصال بمصادر البيانات المختلفة لجمع المعلومات الخام المطلوبة للتحليل." },
            es: { title: "Extracción de Datos", desc: "Conexión a diversas fuentes de datos para recopilar la información necesaria para el análisis." }
        },
        clean: {
            en: { title: "Data Cleaning & Transformation", desc: "Using Power Query to remove duplicates, fix errors, and transform data into a usable, structured format." },
            ar: { title: "تنظيف وتحويل البيانات", desc: "استخدام Power Query لإزالة التكرارات، وإصلاح الأخطاء، وتحويل البيانات إلى تنسيق هيكلي قابل للاستخدام." },
            es: { title: "Limpieza de Datos", desc: "Uso de Power Query para eliminar duplicados, corregير errores y transformar los datos." }
        },
        model: {
            en: { title: "Data Modeling & DAX", desc: "Creating relationships between tables and writing DAX formulas to calculate complex business metrics." },
            ar: { title: "نمذجة البيانات و DAX", desc: "إنشاء العلاقات بين الجداول وكتابة صيغ DAX لحساب مقاييس الأعمال المعقدة." },
            es: { title: "Modelado y DAX", desc: "Creación de relaciones entre tablas y escritura de fórmulas DAX para métricas complejas." }
        },
        insight: {
            en: { title: "Insights & Visualization", desc: "Designing intuitive dashboards that tell a story and help decision-makers take confident actions." },
            ar: { title: "الرؤى والتمثيل المرئي", desc: "تصميم لوحات بيانات بديهية تحكي قصة البيانات وتساعد صناع القرار على اتخاذ إجراءات واثقة." },
            es: { title: "Perspectivas y Visualización", desc: "Diseño de cuadros de mando intuitivos que cuentan una historia y ayudan a los tomadores de decisiones." }
        }
    };
    const expertiseData = {
        powerbi: {
            en: { title: "Power BI", desc: "Advanced expertise in Power BI for creating interactive dashboards, connecting complex data sources, and building scalable BI solutions that drive strategic insights." },
            ar: { title: "Power BI", desc: "خبرة متقدمة في Power BI لإنشاء لوحات بيانات تفاعلية، وربط مصادر البيانات المعقدة، وبناء حلول ذكاء أعمال قابلة للتوسع تدفع الرؤى الاستراتيجية." },
            es: { title: "Power BI", desc: "Experiencia avanzada en Power BI para crear cuadros de mando interactivos y soluciones de BI." }
        },
        excel: {
            en: { title: "Advanced Excel", desc: "Mastery of Excel for data manipulation, using Power Query for ETL processes, and Pivot Tables for rapid data summarization and analysis." },
            ar: { title: "إكسيل متقدم", desc: "إتقان إكسيل لمعالجة البيانات، واستخدام Power Query لعمليات ETL، والجداول المحورية لتلخيص وتحليل البيانات بسرعة." },
            es: { title: "Excel Avanzado", desc: "Maestría en Excel para manipulación de datos y Power Query." }
        },
        sql: {
            en: { title: "SQL Querying", desc: "Proficient in writing complex SQL queries to extract, filter, and aggregate data from relational databases, ensuring a clean data foundation for analysis." },
            ar: { title: "استعلامات SQL", desc: "براعة في كتابة استعلامات SQL المعقدة لاستخراج وتصفية وتجميع البيانات من قواعد البيانات المختلفة." },
            es: { title: "SQL", desc: "Competente en la escritura de consultas SQL complejas." }
        },
        modeling: {
            en: { title: "Data Modeling", desc: "Implementing Star and Snowflake schemas to optimize report performance and ensure data integrity across multiple tables." },
            ar: { title: "نمذجة البيانات", desc: "تنفيذ مخططات Star و Snowflake لتحسين أداء التقارير وضمان سلامة البيانات عبر الجداول المتعددة." },
            es: { title: "Modelado de Datos", desc: "Implementación de esquemas Star y Snowflake." }
        },
        dax: {
            en: { title: "DAX Logic", desc: "Crafting efficient DAX formulas to calculate advanced business metrics, time intelligence, and custom dynamic KPIs." },
            ar: { title: "منطق DAX", desc: "صياغة معادلات DAX فعالة لحساب مقاييس الأعمال المتقدمة، وذكاء الوقت، ومؤشرات الأداء الديناميكية." },
            es: { title: "Lógica DAX", desc: "Creación de fórmulas DAX eficientes." }
        },
        etl: {
            en: { title: "ETL Processes", desc: "Designing automated Extract, Transform, and Load workflows to streamline data preparation and reduce manual errors." },
            ar: { title: "عمليات ETL", desc: "تصميم تدفقات عمل (استخراج، تحويل، تحميل) مؤتمتة لتبسيط إعداد البيانات وتقليل الأخطاء اليدوية." },
            es: { title: "Procesos ETL", desc: "Diseño de flujos de trabajo ETL automatizados." }
        },
        viz: {
            en: { title: "Data Visualization", desc: "Applying data storytelling principles to design clear and intuitive visuals that highlight trends and key findings for stakeholders." },
            ar: { title: "تمثيل البيانات", desc: "تطبيق مبادئ سرد القصص بالبيانات لتصميم مرئيات واضحة وبديهية تبرز الاتجاهات والنتائج الرئيسية." },
            es: { title: "Visualización de Datos", desc: "Aplicación de principios de storytelling de datos." }
        }
    };

    const projectData = {
        hr: { 
            en: { title: "HR Attrition Analysis", o: "Identify factors behind turnover.", c: "High turnover rates.", s: "Power BI dashboard with DAX.", i: "15% reduction opportunity.", t: "Power BI, DAX" },
            ar: { title: "تحليل استقالات الموظفين", o: "تحديد أسباب ترك العمل.", c: "معدلات دوران عالية.", s: "لوحة بيانات Power BI.", i: "فرصة تقليل 15%.", t: "Power BI, DAX" },
            es: { title: "Análisis de Rotación", o: "Identificar factores.", c: "Alta rotación.", s: "Dashboard Power BI.", i: "Meجora del 15%.", t: "Power BI, DAX" },
            imgs: ['hr.png.png', 'hr.png2.png', 'hr.png3.png']
        },
        sales: {
            en: { title: "Sales Performance Hub", o: "Centralize sales data.", c: "Fragmented data.", s: "Unified ETL pipeline.", i: "40% faster reporting.", t: "Excel, Power BI" },
            ar: { title: "مركز أداء المبيعات", o: "مركزية البيانات.", c: "بيانات مشتتة.", s: "مسار ETL موحد.", i: "سرعة تقارير 40%.", t: "Excel, Power BI" },
            es: { title: "Hub de Ventas", o: "Centralizar datos.", c: "Datos fragmentados.", s: "Pipeline ETL.", i: "40% más rápido.", t: "Excel, Power BI" },
            imgs: ['sales.png1.png', 'sales.png2.png', 'sales.png3.png']
        },
        furniture: { 
            en: { title: "Furniture Loss Analysis", o: "Analyze loss patterns in furniture sales.", c: "High return and loss rates.", s: "Advanced Power BI dashboard.", i: "Identification of key loss drivers.", t: "Power BI, DAX" },
            ar: { title: "تحليل خسائر الأثاث", o: "تحليل أنماط الخسارة في مبيعات الأثاث.", c: "معدلات مرتفعة من المرتجعات والخسائر.", s: "لوحة بيانات Power BI متطورة.", i: "تحديد الدوافع الرئيسية للخسارة.", t: "Power BI, DAX" },
            es: { title: "Análisis de Pérdida de Muebles", o: "Analizar patrones de pérdida.", c: "Altas tasas de devolución.", s: "Dashboard avanzado de Power BI.", i: "Identificación de factores de pérdida.", t: "Power BI, DAX" },
            imgs: ['Overviewpng1.png', 'Furniture Loss Analysispng2.png', 'Stakeholders Analysispng3.png']
        }
    };

function updateUI() {
    const t = translations[currentLang];
    document.body.className = currentLang === 'ar' ? 'rtl' : '';
    
    if (isDarkMode) {
        document.body.classList.add('dark-theme');
    } else {
        document.body.classList.remove('dark-theme');
    }
    document.getElementById('welcome-name').innerText = t.name;
    document.getElementById('welcome-tagline').innerText = t.tagline;
    document.getElementById('welcome-btn').innerText = t.welcomeBtn; 
    document.getElementById('main-name').innerText = t.name;
    document.getElementById('about-me').innerHTML = t.about;
    document.getElementById('title-journey').innerText = t.journey;
    document.getElementById('title-expertise').innerText = t.expertise;
    document.getElementById('title-projects').innerText = t.projects;
    document.getElementById('title-ratings').innerText = t.ratings;
    document.getElementById('title-why-me').innerText = t.whyMe;
    document.getElementById('why1-t').innerText = t.why1t; document.getElementById('why1-d').innerText = t.why1d;
    document.getElementById('why2-t').innerText = t.why2t; document.getElementById('why2-d').innerText = t.why2d;
    document.getElementById('why3-t').innerText = t.why3t; document.getElementById('why3-d').innerText = t.why3d;
    document.getElementById('step1').innerText = t.step1;
    document.getElementById('step2').innerText = t.step2;
    document.getElementById('step3').innerText = t.step3;
    document.getElementById('step4').innerText = t.step4;
    document.getElementById('step5').innerText = t.step5;
    document.getElementById('skill3').innerText = t.skill3;
    document.getElementById('skill4').innerText = t.skill4;
    document.getElementById('skill6').innerText = t.skill6;    
    document.getElementById('exp1').innerText = t.exp1;
    document.getElementById('exp2').innerText = t.exp2;
    document.getElementById('exp3').innerText = t.exp3;
    document.getElementById('exp4').innerText = t.exp4;    
    document.getElementById('p1-title').innerText = projectData.hr[currentLang].title;
    document.getElementById('p2-title').innerText = projectData.sales[currentLang].title;
    document.getElementById('p3-title').innerText = projectData.furniture[currentLang].title;
    document.getElementById('p1-btn').innerText = t.viewBtn;
    document.getElementById('p2-btn').innerText = t.viewBtn;
    document.getElementById('p3-btn').innerText = t.viewBtn;
    document.getElementById('back-btn').innerText = t.back;
    document.getElementById('view-ratings-text').innerText = t.viewRatings;
    // تمت إزالة تحديث نص CV لأنه لم يعد موجوداً في الهيدر
    document.getElementById('lang-label').innerText = t.lang;

    const iconContainer = document.getElementById('dark-mode-toggle');
    iconContainer.innerHTML = isDarkMode ? 
        `<svg viewBox="0 0 24 24"><path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"/></svg>` : 
        `<svg viewBox="0 0 24 24"><path d="M12 3a9 9 0 1 0 9 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 0 1-4.4 5.06 5.406 5.406 0 0 1-5.6-5.6c.33-2.36 2.06-4.24 4.4-4.89C14.15 3.09 13.09 3 12 3z"/></svg>`;
}
    function setLang(lang) {
        currentLang = lang;
        localStorage.setItem('ahmedLang', lang);
        jobIdx = 0; charIdx = 0;
        updateUI();
    }
    function toggleDarkMode() {
        isDarkMode = !isDarkMode;
        localStorage.setItem('ahmedDarkMode', isDarkMode);
        updateUI();
    }
    // دالة نسخ البريد تم تعديلها لتنبيه المستخدم بالنسخ فقط دون الاعتماد على نص الإيميل تحتها
    function copyEmail(email) {
        navigator.clipboard.writeText(email).then(() => {
            alert(translations[currentLang].copyMsg);
        });
    }
    function startExploring() {
        const overlay = document.getElementById('welcome-overlay');
        overlay.classList.add('slide-up');  
        setTimeout(() => { 
            overlay.style.display = 'none'; 
            const main = document.getElementById('main-site'); 
            main.style.display = 'block'; 
            setTimeout(() => {
                main.style.opacity = '1';
                startTypingEffect();
            }, 50); 
            updateUI();
        }, 1000);
    }
    function showJourney(id) {
        lastScrollPos = window.scrollY;
        const d = journeyData[id][currentLang];
        document.getElementById('case-header-content').innerHTML = `
            <div class="case-header">
                <h2>${d.title}</h2>
                <p style="font-size:18px; line-height:1.8; color:var(--text-gray);">${d.desc}</p>
            </div>`;
        document.getElementById('study-images').innerHTML = "";
        document.getElementById('main-site').style.display = 'none';
        document.getElementById('case-study-view').style.display = 'block';
        window.scrollTo(0,0);
    }

    function showExpertise(id) {
        lastScrollPos = window.scrollY;
        const d = expertiseData[id][currentLang];
        document.getElementById('case-header-content').innerHTML = `
            <div class="case-header">
                <h2>${d.title}</h2>
                <p style="font-size:18px; line-height:1.8; color:var(--text-gray);">${d.desc}</p>
            </div>`;
        document.getElementById('study-images').innerHTML = "";
        document.getElementById('main-site').style.display = 'none';
        document.getElementById('case-study-view').style.display = 'block';
        window.scrollTo(0,0);
    }
    function openRatingsPage() {
        lastScrollPos = window.scrollY;
        const t = translations[currentLang];
        const ratingsHtml = `
            <div class="rating-input-section">
                <h4>${t.ratePrompt}</h4>
                <div class="stars" id="star-rating">
                    <span data-value="1" onclick="setRating(1)">★</span>
                    <span data-value="2" onclick="setRating(2)">★</span>
                    <span data-value="3" onclick="setRating(3)">★</span>
                    <span data-value="4" onclick="setRating(4)">★</span>
                    <span data-value="5" onclick="setRating(5)">★</span>
                </div>
                <div id="rating-form">
                    <input type="text" id="user-name" class="rating-input" placeholder="${t.namePlace}"><br>
                    <textarea id="user-comment" class="rating-input" rows="3" placeholder="${t.ratePlace}"></textarea><br>
                    <button class="submit-rate-btn" onclick="submitRating()">${t.rateBtn}</button>
                </div>
            </div>
            <div class="grid-container" id="ratings-display-inner">
                <p class="loading-text">${t.loading}</p>
            </div>`;   
        document.getElementById('case-header-content').innerHTML = ratingsHtml;
        document.getElementById('study-images').innerHTML = "";
        document.getElementById('main-site').style.display = 'none';
        document.getElementById('case-study-view').style.display = 'block';
        window.scrollTo(0,0);
        fetchReviews();
        setRating(5);
    }
    function setRating(val) {
        selectedRating = val;
        document.querySelectorAll('#star-rating span').forEach((star, idx) => {
            star.classList.toggle('active', idx < val);
        });
    }
    function fetchReviews() {
        fetch(SHEETDB_URL)
        .then(res => res.json())
        .then(data => {
            const container = document.getElementById('ratings-display-inner');
            container.innerHTML = "";
            data.reverse().forEach(rev => {
                const card = document.createElement('div');
                card.className = "card-3d reveal active";
                card.style.maxWidth = "100%";
                card.style.flex = "1 1 300px";
                const isAr = /[\u0600-\u06FF]/.test(rev.Feedback);
                card.setAttribute('dir', isAr ? 'rtl' : 'ltr');
                card.style.textAlign = isAr ? 'right' : 'left';
                let stars = '★'.repeat(rev.Rating || 5) + '☆'.repeat(5 - (rev.Rating || 5));
                card.innerHTML = `
                    <strong style="display:block; margin-top:5px; color:var(--main-blue);">${rev.Name}</strong>
                    <p style="font-style: italic; font-size: 14px; margin: 5px 0;">${rev.Feedback}</p>
                    <div style="color: #ffce00;">${stars}</div>`;
                container.appendChild(card);
            });
        }).catch(() => {
            document.getElementById('ratings-display-inner').innerHTML = "No reviews found.";
        });
    }
    function submitRating() {
        const name = document.getElementById('user-name').value;
        const comment = document.getElementById('user-comment').value;
        const t = translations[currentLang];
        if (!name || !comment) { alert(t.alert); return; }

        const data = {
            Name: name,
            Feedback: comment,
            Rating: selectedRating,
            Date: new Date().toLocaleDateString()
        };
        fetch(SHEETDB_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ data: [data] })
        })
        .then(res => res.json())
        .then(() => {
            alert(t.thanks);
            openRatingsPage();
        });
    }
    function showStudy(id) {
        lastScrollPos = window.scrollY;
        const d = projectData[id][currentLang];
        const t = translations[currentLang];
        const imgs = projectData[id].imgs.map(src => `<img src="${src}" style="width:100%; margin-bottom:20px; border-radius:15px;">`).join('');
        document.getElementById('case-header-content').innerHTML = `
            <div class="case-header">
                <h2>${d.title}</h2>
                <p><b>${t.obj}:</b> ${d.o}</p>
                <div class="detail-grid">
                    <div><b style="color:var(--main-blue)">${t.ch}</b><br>${d.c}</div>
                    <div><b style="color:var(--main-blue)">${t.sol}</b><br>${d.s}</div>
                    <div><b style="color:var(--main-blue)">${t.imp}</b><br>${d.i}</div>
                    <div><b style="color:var(--main-blue)">${t.tool}</b><br>${d.t}</div>
                </div>
            </div>`;
        document.getElementById('study-images').innerHTML = imgs;
        document.getElementById('main-site').style.display = 'none';
        document.getElementById('case-study-view').style.display = 'block';
        window.scrollTo(0,0);
    }
    function hideStudy() {
        document.getElementById('case-study-view').style.display = 'none';
        document.getElementById('main-site').style.display = 'block';
        window.scrollTo(0, lastScrollPos);
    }

    window.addEventListener('scroll', () => {
        const btn = document.getElementById('back-to-top');
        if (window.scrollY > 500) {
            btn.style.display = "flex";
        } else {
            btn.style.display = "none";
        }

        document.querySelectorAll('.reveal').forEach(el => {
            if (el.getBoundingClientRect().top < window.innerHeight - 50) el.classList.add('active');
        });
    });

    window.onload = updateUI;
</script>
</body>
</html>
