<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ahmed Gharib | AGBINSIGHTS</title>
    
    <link rel="icon" type="image/png" href="agb-logo.png.1.jpeg">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root { 
            --main-blue: #4a90e2; 
            --bg-white: #ffffff; 
            --deep-black: #000000;
            --text-gray: #555555; 
            --glow-effect: 0 4px 15px rgba(74, 144, 226, 0.2);
        }

       body { background-color: var(--bg-white); color: var(--deep-black); font-family: 'Inter', sans-serif; margin: 0; text-align: center; scroll-behavior: smooth; overflow-x: hidden; }
       body.rtl { direction: rtl; font-family: 'Cairo', sans-serif; }
       
        #welcome-overlay { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: var(--bg-white);
            display: flex; align-items: center; justify-content: center; 
            z-index: 10000; transition: 1s cubic-bezier(0.85, 0, 0.15, 1); 
        }
        #welcome-overlay.slide-up { transform: translateY(-100%); }
        .welcome-box { text-align: center; padding: 20px; }
        .welcome-logo { width: 120px; height: 120px; margin-bottom: 25px; border-radius: 50%; border: 3px solid var(--main-blue); transition: 0.3s; object-fit: contain; }
        .start-btn { background: var(--main-blue); color: white; padding: 15px 40px; border: none; border-radius: 50px; font-weight: 900; cursor: pointer; margin-top: 30px; text-transform: uppercase; letter-spacing: 2px; box-shadow: 0 4px 15px rgba(74, 144, 226, 0.3); }

        #main-site { opacity: 0; display: none; }
        
        nav { width: 100%; padding: 10px 5%; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.05); background: var(--bg-white); position: sticky; top: 0; z-index: 1000; box-sizing: border-box; direction: ltr !important; }
        .nav-brand { display: flex; align-items: center; gap: 10px; }
        .nav-logo-img { height: 80px; width: auto; transition: 0.4s ease; cursor: pointer; mix-blend-mode: multiply; filter: contrast(1.1); }
        body.dark-theme .nav-logo-img { filter: none; mix-blend-mode: normal; }

        .lang-switch { display: flex; gap: 12px; align-items: center; }
        .flag-btn { width: 32px; height: 32px; cursor: pointer; border-radius: 50%; opacity: 0.8; transition: 0.3s; object-fit: cover; border: 2px solid transparent; }
        .flag-btn.active { opacity: 1; border: 2px solid var(--main-blue); transform: scale(1.15); }

        #dark-mode-toggle { cursor: pointer; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; }
        #dark-mode-toggle svg { width: 22px; height: 22px; fill: var(--main-blue); }

        header { padding: 60px 20px; text-align: center; }
        h1 { font-size: clamp(35px, 8vw, 75px); margin: 0; font-weight: 900; }
        .job-tag { color: var(--main-blue); font-size: 16px; letter-spacing: 3px; font-weight: 700; text-transform: uppercase; display: inline-block; margin-top: 10px; min-height: 1.2em; }
        .job-tag::after { content: "|"; animation: blink 0.7s infinite; }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }

        .about-text { max-width: 800px; margin: 25px auto; color: var(--text-gray); font-size: 17px; line-height: 1.6; padding: 0 20px; border-left: 3px solid var(--main-blue); }
        body.rtl .about-text { border-left: none; border-right: 3px solid var(--main-blue); }

        .section-title { text-align: left; margin: 40px 0 20px 10%; color: var(--deep-black); border-left: 5px solid var(--main-blue); padding-left: 15px; font-weight: bold; font-size: 24px; }
        body.rtl .section-title { text-align: right; border-left: none; border-right: 5px solid var(--main-blue); padding-left: 0; padding-right: 15px; margin: 40px 10% 20px 0; }

        .grid-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 20px; padding: 0 10%; margin-bottom: 40px; }
        .expertise-box { background: var(--bg-white); border: 1px solid #eee; padding: 25px 15px; border-radius: 15px; transition: all 0.3s ease; text-align: center; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .expertise-box:hover { transform: translateY(-10px); box-shadow: 0 10px 20px rgba(74, 144, 226, 0.15); border-color: var(--main-blue); }
        .expertise-box svg { width: 45px; height: 45px; margin-bottom: 15px; fill: var(--main-blue); }
        .expertise-box p { margin: 0; font-weight: bold; font-size: 15px; }

        .process-flow { display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; padding: 0 10%; margin-bottom: 40px; }
        .process-step { background: var(--bg-white); border: 1px solid #eee; padding: 25px 15px; flex: 1 1 130px; max-width: 200px; border-radius: 15px; transition: all 0.3s ease; cursor: pointer; text-align: center; display: flex; flex-direction: column; align-items: center; }
        .process-step svg { width: 35px; height: 35px; fill: var(--main-blue); margin-bottom: 15px; }
        .process-step:hover { transform: translateY(-5px); border-color: var(--main-blue); box-shadow: 0 10px 20px rgba(74, 144, 226, 0.1); }

        .projects-wrapper { display: flex; flex-direction: column; gap: 40px; padding: 0 10%; }
        .project-item { display: flex; flex-direction: column; background: var(--bg-white); border: 1px solid #eee; border-radius: 20px; overflow: hidden; width: 100%; }
        .p-img img { width: 100%; height: auto; display: block; object-fit: cover; }
        .p-text { width: 100%; padding: 30px; box-sizing: border-box; text-align: center; }
        @media (min-width: 768px) {
            .project-item { flex-direction: row; }
            .p-img { width: 60%; } 
            .p-text { width: 40%; padding: 40px; display: flex; flex-direction: column; justify-content: center; text-align: left; }
            body.rtl .p-text { text-align: right; }
        }

        .btn-view { border: 2px solid var(--main-blue); color: var(--main-blue); padding: 12px 30px; border-radius: 10px; cursor: pointer; display: inline-block; margin-top: 20px; font-weight: 800; transition: 0.3s; }
        .btn-view:hover { background: var(--main-blue); color: #fff; }
        
        #case-study-view { display:none; background: var(--bg-white); padding: 40px 10%; text-align: left; }
        body.rtl #case-study-view { text-align: right; }
        .case-header { background: #f9f9f9; padding: 30px; border-radius: 20px; border-left: 6px solid var(--main-blue); margin-bottom: 30px; }
        body.rtl .case-header { border-left: none; border-right: 6px solid var(--main-blue); }

        .rating-input-section { margin-bottom: 30px; padding: 30px; background: #f9f9f9; border-radius: 20px; text-align: center; }
        .stars { font-size: 24px; margin-bottom: 10px; cursor: pointer; display: flex; justify-content: center; gap: 5px; }
        .star-svg-input { width: 25px; height: 25px; fill: #ccc; }
        .star-svg-input.active { fill: #ffce00; }
        .rating-input { width: 100%; max-width: 400px; padding: 12px; border: 1px solid #ddd; border-radius: 10px; margin-bottom: 10px; }
        .submit-rate-btn { background: var(--main-blue); color: white; border: none; padding: 10px 25px; border-radius: 8px; cursor: pointer; font-weight: bold; }

        footer { padding: 60px 20px; margin-top: 50px; }
        .social-icons { display: flex; justify-content: center; gap: 25px; }
        .social-icons svg { width: 35px; height: 35px; fill: var(--deep-black); transition: 0.3s; }
        .social-icons a:hover svg { fill: var(--main-blue); transform: translateY(-3px); }

        body.dark-theme { --bg-white: #111111; --deep-black: #ffffff; --text-gray: #bbbbbb; }
        body.dark-theme .expertise-box, body.dark-theme .process-step, body.dark-theme .project-item, body.dark-theme .case-header, body.dark-theme .rating-input-section { background: #000000; border-color: #222; }
        body.dark-theme .social-icons svg { fill: #ffffff; }

        .reveal { opacity: 0; transform: translateY(30px); transition: all 0.8s ease-out; }
        .reveal.active { opacity: 1; transform: translateY(0); }
    </style>
</head>
<body>

<div id="welcome-overlay">
    <div class="welcome-box">
       <img src="agb-logo-png.png" class="welcome-logo" id="welcome-logo-img">
       <h2 id="welcome-name">Ahmed Gharib</h2>
       <p id="welcome-tagline">Turning Complex Data into Strategic Assets</p>
       <button class="start-btn" onclick="startExploring()" id="welcome-btn">Explore Insights</button>
    </div>
</div>

<div id="main-site">
    <nav>
        <div class="nav-brand"><img src="agb-logo-png.png" class="nav-logo-img" id="nav-logo-img" onclick="location.reload()"></div>
        <div class="lang-switch">
            <img src="https://flagcdn.com/w40/gb.png" class="flag-btn" id="lang-en" onclick="setLang('en')">
            <img src="https://flagcdn.com/w40/eg.png" class="flag-btn" id="lang-ar" onclick="setLang('ar')">
            <img src="https://flagcdn.com/w40/es.png" class="flag-btn" id="lang-es" onclick="setLang('es')">
            <div id="dark-mode-toggle" onclick="toggleDarkMode()"><svg id="theme-icon-svg" viewBox="0 0 512 512"></svg></div>
        </div>
    </nav>

    <header>
        <h1 id="main-name">Ahmed Gharib</h1>
        <span class="job-tag" id="job-title"></span>
        <p class="about-text" id="about-me"></p>
    </header>

    <div class="section-title" id="title-journey"></div>
    <div class="process-flow">
        <div class="process-step reveal" onclick="showJourney('understand')">
            <svg viewBox="0 0 512 512"><path d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM216 336h40V272H216V240h72v96h40v32H216V336zM256 160a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"/></svg>
            <h4 id="step1"></h4>
        </div>
        <div class="process-step reveal" onclick="showJourney('extract')">
            <svg viewBox="0 0 448 512"><path d="M208 0H332.1c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9V336c0 26.5-21.5 48-48 48H208c-26.5 0-48-21.5-48-48V48c0-26.5 21.5-48 48-48zM48 128h80v64H48V448H256V384h64v64c0 35.3-28.7 64-64 64H48c-35.3 0-64-28.7-64-64V192c0-35.3 28.7-64 64-64z"/></svg>
            <h4 id="step2"></h4>
        </div>
        <div class="process-step reveal" onclick="showJourney('clean')">
            <svg viewBox="0 0 512 512"><path d="M4.1 38.2C1.4 34.2 0 29.4 0 24.5C0 11 11 0 24.5 0H198.2c16.3 0 31.2 9.2 38.4 23.8L272 96h192c26.5 0 48 21.5 48 48V464c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V48c0-3.3 .3-6.6 1-9.8z"/></svg>
            <h4 id="step3"></h4>
        </div>
        <div class="process-step reveal" onclick="showJourney('model')">
            <svg viewBox="0 0 448 512"><path d="M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z"/></svg>
            <h4 id="step4"></h4>
        </div>
        <div class="process-step reveal" onclick="showJourney('insight')">
            <svg viewBox="0 0 352 512"><path d="M176 0c-44.2 0-80 35.8-80 80c0 4.4 .4 8.8 1.1 13l-48.4 48.4c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l48.4-48.4c4.2 .7 8.6 1.1 13 1.1c44.2 0 80-35.8 80-80s-35.8-80-80-80zm0 112a32 32 0 1 1 0-64 32 32 0 1 1 0 64zM48 224h16v32H48c-8.8 0-16 7.2-16 16v144c0 8.8 7.2 16 16 16h256c8.8 0 16-7.2 16-16V288c0-8.8-7.2-16-16-16h-16V224h16c26.5 0 48 21.5 48 48v144c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V272c0-26.5 21.5-48 48-48z"/></svg>
            <h4 id="step5"></h4>
        </div>
    </div>

    <div class="section-title" id="title-expertise"></div>
    <div class="grid-container"> 
        <div class="expertise-box reveal">
            <svg viewBox="0 0 512 512"><path d="M32 32c17.7 0 32 14.3 32 32V400c0 8.8 7.2 16 16 16H480c17.7 0 32 14.3 32 32s-14.3 32-32 32H80c-44.2 0-80-35.8-80-80V64C0 46.3 14.3 32 32 32zM160 224c17.7 0 32 14.3 32 32v64c0 17.7-14.3 32-32 32s-32-14.3-32-32V256c0-17.7 14.3-32 32-32zm128-64c17.7 0 32 14.3 32 32v128c0 17.7-14.3 32-32 32s-32-14.3-32-32V192c0-17.7 14.3-32 32-32zm128-64c17.7 0 32 14.3 32 32v192c0 17.7-14.3 32-32 32s-32-14.3-32-32V128c0-17.7 14.3-32 32-32z"/></svg>
            <p>Power BI</p>
        </div>
        <div class="expertise-box reveal">
            <svg viewBox="0 0 384 512"><path d="M64 0C28.7 0 0 28.7 0 64V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V160H256c-17.7 0-32-14.3-32-32V0H64zM256 0V128H384L256 0zM128 224l32 32 32-32c12.5-12.5 32.8-12.5 45.3 0s12.5 32.8 0 45.3L205.3 304l32 32c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L160 349.3l-32 32c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l32-32L82.7 269.3c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0z"/></svg>
            <p>Excel</p>
        </div>
        <div class="expertise-box reveal">
            <svg viewBox="0 0 448 512"><path d="M448 80v48c0 44.2-100.3 80-224 80S0 172.2 0 128V80C0 35.8 100.3 0 224 0S448 35.8 448 80zM393.2 214.7c20.8-7.4 39.9-16.9 54.8-28.7V288c0 44.2-100.3 80-224 80S0 332.2 0 288V186c14.9 11.8 34 21.2 54.8 28.7C99.7 230.5 159.3 240 224 240s124.3-9.5 169.2-25.3zM0 346c14.9 11.8 34 21.2 54.8 28.7C99.7 390.5 159.3 400 224 400s124.3-9.5 169.2-25.3c20.8-7.4 39.9-16.9 54.8-28.7V432c0 44.2-100.3 80-224 80S0 476.2 0 432V346z"/></svg>
            <p id="skill3"></p>
        </div>
        <div class="expertise-box reveal">
            <svg viewBox="0 0 640 512"><path d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6zm80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3L562.7 256l-89.3 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L165.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0z"/></svg>
            <p id="skill4"></p>
        </div>
        <div class="expertise-box reveal">
            <svg viewBox="0 0 512 512"><path d="M3.9 54.9C10.5 40.9 24.5 32 40 32H472c15.5 0 29.5 8.9 36.1 22.9s4.6 30.5-5.2 42.5L320 320.9V448c0 12.1-6.8 23.2-17.7 28.6l-128 64c-11.3 5.6-24.9 4.4-35.1-3.1S128 516.1 128 504V320.9L3.9 97.5C-5.9 85.5-6.5 68.8 3.9 54.9z"/></svg>
            <p>ETL</p>
        </div>
        <div class="expertise-box reveal">
            <svg viewBox="0 0 576 512"><path d="M288 32c-80.8 0-145.5 64.7-145.5 145.5 0 26.5 7.1 51.3 19.6 72.7L32 480h46.3l61.2-103.7c20.5 13.7 45 21.7 71.5 21.7 80.8 0 145.5-64.7 145.5-145.5S368.8 32 288 32zm0 244.1c-54.4 0-98.6-44.2-98.6-98.6s44.2-98.6 98.6-98.6 98.6 44.2 98.6 98.6-44.1 98.6-98.6 98.6zM544 480l-91.4-154.9c13.7-20.5 21.7-45 21.7-71.5 0-80.8-64.7-145.5-145.5-145.5-26.5 0-51.3 7.1-72.7 19.6L497.7 480H544z"/></svg>
            <p id="skill6"></p>
        </div>
    </div>

    <div class="section-title" id="title-projects"></div>
    <div class="projects-wrapper">
        <div class="project-item reveal"> 
            <div class="p-img"><img src="hr.png.png"></div>
            <div class="p-text"><h3 id="p1-title"></h3><div class="btn-view" onclick="showStudy('hr')" id="p1-btn"></div></div>
        </div>
        <div class="project-item reveal">
            <div class="p-img"><img src="sales.png1.png"></div>
            <div class="p-text"><h3 id="p2-title"></h3><div class="btn-view" onclick="showStudy('sales')" id="p2-btn"></div></div>
        </div>
    </div>

    <div class="section-title" id="title-ratings"></div>
    <div class="grid-container" style="display: flex; justify-content: center;">
        <div class="expertise-box reveal" onclick="openRatingsPage()" style="cursor: pointer; min-width: 250px;">
            <svg style="width:32px; height:32px; fill:#ffce00; margin-bottom:10px;" viewBox="0 0 576 512"><path d="M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z"/></svg>
            <p id="view-ratings-text"></p>
        </div>
    </div>

    <footer>
        <div class="social-icons">
            <a href="https://www.linkedin.com/in/ahmed-gharib-20989a272/" target="_blank">
                <svg viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
            </a>
            <a href="mailto:info@agbinsights.com">
                <svg viewBox="0 0 512 512"><path d="M64 112c-8.8 0-16 7.2-16 16v22.1L220.5 291.7c20.7 17 50.4 17 71.1 0L464 150.1V128c0-8.8-7.2-16-16-16H64zM48 212.2V384c0 8.8 7.2 16 16 16H448c8.8 0 16-7.2 16-16V212.2L322 328.8c-38.4 31.5-93.7 31.5-132 0L48 212.2zM0 128C0 92.7 28.7 64 64 64H448c35.3 0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V128z"/></svg>
            </a>
        </div>
        <p style="margin-top: 20px; opacity: 0.6; font-size: 12px;">©️ AHMED GHARIB | AGBINSIGHTS</p>
    </footer>
</div>

<div id="case-study-view">
    <div onclick="hideStudy()" id="back-btn" style="color:var(--main-blue); cursor:pointer; margin-bottom:30px; font-weight:bold;"></div>
    <div id="case-header-content"></div>
    <div id="study-images"></div>
</div>

<script>
    let currentLang = localStorage.getItem('ahmedLang') || 'en';
    let isDarkMode = localStorage.getItem('ahmedDarkMode') === 'true';
    let lastScrollPos = 0;
    let selectedRating = 5;
    const SHEETDB_URL = 'https://sheetdb.io/api/v1/jv44e0ygedwit';

    const translations = {
        en: {
            name: "Ahmed Gharib", welcomeBtn: "Explore Insights", tagline: "Turning Complex Data into Actionable Insights",
            about: "I help organizations make sense of their data by converting complex datasets into clear, actionable insights. Through data analysis and visualization, I support better decisions, performance improvement, and measurable business results.",
            journey: "01. Journey", expertise: "02. Expertise", projects: "03. Projects", ratings: "04. Ratings",
            step1: "Understand", step2: "Extract", step3: "Clean", step4: "Model", step5: "Insight",
            skill3: "Modeling", skill4: "DAX Logic", skill6: "Viz", viewBtn: "View Details", back: "← BACK TO HOME",
            obj: "OBJECTIVE", ch: "CHALLENGE", sol: "SOLUTION", imp: "IMPACT", tool: "TOOLS",
            ratePrompt: "Leave a Review", namePlace: "Name", ratePlace: "Write your feedback...", rateBtn: "Submit",
            alert: "Please enter both name and comment", thanks: "Thank you for your feedback!",
            viewRatings: "View & Add Reviews", loading: "Loading reviews..."
        },
        ar: {
            name: "أحمد غريب", welcomeBtn: "استكشاف التفاصيل", tagline: "تحويل البيانات المعقدة إلى رؤى استراتيجية",
            about: "أساعد المؤسسات على فهم بياناتها من خلال تحويل مجموعات البيانات المعقدة إلى رؤى واضحة وقابلة للتنفيذ. من خلال تحليل البيانات والتمثيل المرئي، أدعم اتخاذ قرارات أفضل، وتحسين الأداء، وتحقيق نتائج أعمال ملموسة.",
            journey: "01. الرحلة", expertise: "02. الخبرات", projects: "03. المشاريع", ratings: "04. التقييمات",
            step1: "الفهم", step2: "استخراج", step3: "تنظيف", step4: "نمذجة", step5: "رؤية",
            skill3: "نمذجة", skill4: "منطق DAX", skill6: "تصوير", viewBtn: "عرض التفاصيل", back: "← العودة للرئيسية",
            obj: "الهدف", ch: "التحدي", sol: "الحل", imp: "الأثر", tool: "الأدوات",
            ratePrompt: "أضف تقييمك", namePlace: "الاسم", ratePlace: "اكتب رأيك هنا...", rateBtn: "إرسال",
            alert: "يرجى إدخال الاسم والتعليق", thanks: "شكراً لتقييمك!",
            viewRatings: "عرض وإضافة التقييمات", loading: "جاري تحميل التقييمات..."
        },
        es: {
            name: "Ahmed Gharib", welcomeBtn: "Explorar Detalles", tagline: "Convirtiendo Datos Complejos en Perspectivas Accionables",
            about: "Ayudo a las organizaciones a dar sentido a sus datos convirtiendo conjuntos de datos complejos en conocimientos claros y procesables. A través del análisis y la visualización, apoyo mejores decisiones y resultados comerciales mensurables.",
            journey: "01. Trayectoria", expertise: "02. Experiencia", projects: "03. Proyectos", ratings: "04. Valoraciones",
            step1: "Entender", step2: "Extraer", step3: "Limpiar", step4: "Modelar", step5: "Perspectiva",
            skill3: "Modelado", skill4: "Lógica DAX", skill6: "Viz", viewBtn: "Ver Detalles", back: "← VOLVER AL INICIO",
            obj: "OBJETIVO", ch: "DESAFÍO", sol: "SOLUCIÓN", imp: "IMPACTO", tool: "HERRAMIENTAS",
            ratePrompt: "Deja una reseña", namePlace: "Nombre", ratePlace: "Escribe tu opinión...", rateBtn: "Enviar",
            alert: "Por favor, introduzca su nombre y comentario", thanks: "¡Gracias por tu comentario!",
            viewRatings: "Ver y añadir reseñas", loading: "Cargando reseñas..."
        }
    };

    const typingJobs = {
        en: ["Data Analyst", "Power BI Specialist", "Problem Solver", "Insights Explorer"],
        ar: ["محلل بيانات", "خبير Power BI", "محلل مشكلات", "مستكشف رؤى"],
        es: ["Analista de Datos", "Especialista en Power BI", "Analista de Problemas"]
    };

    let jobIdx = 0; let charIdx = 0; let isDeleting = false;

    function startTypingEffect() {
        const currentJobs = typingJobs[currentLang];
        const target = document.getElementById('job-title');
        if(!target) return;
        const fullText = currentJobs[jobIdx];
        if (isDeleting) { target.innerText = fullText.substring(0, charIdx - 1); charIdx--; }
        else { target.innerText = fullText.substring(0, charIdx + 1); charIdx++; }
        let speed = isDeleting ? 50 : 150;
        if (!isDeleting && charIdx === fullText.length) { isDeleting = true; speed = 2000; }
        else if (isDeleting && charIdx === 0) { isDeleting = false; jobIdx = (jobIdx + 1) % currentJobs.length; speed = 500; }
        setTimeout(startTypingEffect, speed);
    }

    const journeyData = {
        understand: {
            en: { title: "Understand Business Needs", desc: "Defining clear objectives and understanding KPIs critical to business success." },
            ar: { title: "فهم احتياجات العمل", desc: "تحديد أهداف واضحة وفهم مؤشرات الأداء الرئيسية (KPIs) الضرورية لنجاح الأعمال." },
            es: { title: "Entender el Negocio", desc: "Definición de objetivos claros y comprensión de los indicadores clave de rendimiento (KPI)." }
        },
        extract: {
            en: { title: "Data Extraction", desc: "Connecting to various data sources to gather the raw information needed for analysis." },
            ar: { title: "استخراج البيانات", desc: "الاتصال بمصادر البيانات المختلفة لجمع المعلومات الخام المطلوبة للتحليل." },
            es: { title: "Extracción de Datos", desc: "Conexión a diversas fuentes de datos para recopilar la información necesaria." }
        },
        clean: {
            en: { title: "Data Cleaning & Transformation", desc: "Using Power Query to remove duplicates, fix errors, and transform data." },
            ar: { title: "تنظيف وتحويل البيانات", desc: "استخدام Power Query لإزالة التكرارات، وإصلاح الأخطاء، وتحويل البيانات." },
            es: { title: "Limpieza de Datos", desc: "Uso de Power Query para eliminar duplicados, corregir errores y transformar los datos." }
        },
        model: {
            en: { title: "Data Modeling & DAX", desc: "Creating relationships between tables and writing DAX formulas." },
            ar: { title: "نمذجة البيانات و DAX", desc: "إنشاء العلاقات بين الجداول وكتابة صيغ DAX لحساب مقاييس الأعمال المعقدة." },
            es: { title: "Modelado y DAX", desc: "Creación de relaciones entre tablas y escritura de fórmulas DAX." }
        },
        insight: {
            en: { title: "Insights & Visualization", desc: "Designing intuitive dashboards that tell a story and help decision-makers." },
            ar: { title: "الرؤى والتمثيل المرئي", desc: "تصميم لوحات بيانات بديهية تحكي قصة البيانات وتساعد صناع القرار." },
            es: { title: "Perspectivas y Visualización", desc: "Diseño de cuadros de mando intuitivos que cuentan una historia." }
        }
    };

    const projectData = {
        hr: { 
            en: { title: "HR Attrition Analysis", o: "Identify factors behind turnover.", c: "High turnover rates.", s: "Power BI dashboard with DAX.", i: "15% reduction opportunity.", t: "Power BI, DAX" },
            ar: { title: "تحليل استقالات الموظفين", o: "تحديد أسباب ترك العمل.", c: "معدلات دوران عالية.", s: "لوحة بيانات Power BI.", i: "فرصة تقليل 15%.", t: "Power BI, DAX" },
            es: { title: "Análisis de Rotación", o: "Identificar factores.", c: "Alta rotación.", s: "Dashboard Power BI.", i: "Mejora del 15%.", t: "Power BI, DAX" },
            imgs: ['hr.png.png', 'hr.png2.png', 'hr.png3.png']
        },
        sales: {
            en: { title: "Sales Performance Hub", o: "Centralize sales data.", c: "Fragmented data.", s: "Unified ETL pipeline.", i: "40% faster reporting.", t: "Excel, Power BI" },
            ar: { title: "مركز أداء المبيعات", o: "مركزية البيانات.", c: "بيانات مشتتة.", s: "مسار ETL موحد.", i: "سرعة تقارير 40%.", t: "Excel, Power BI" },
            es: { title: "Hub de Ventas", o: "Centralizar datos.", c: "Datos fragmentados.", s: "Pipeline ETL.", i: "40% más rápido.", t: "Excel, Power BI" },
            imgs: ['sales.png1.png', 'sales.png2.png', 'sales.png3.png']
        }
    };

    function updateUI() {
        const t = translations[currentLang];
        document.body.className = currentLang === 'ar' ? 'rtl' : '';
        if (isDarkMode) {
            document.body.classList.add('dark-theme');
            document.getElementById('nav-logo-img').src = "agb-logo.png.1.jpeg";
            document.getElementById('welcome-logo-img').src = "agb-logo.png.1.jpeg";
            document.getElementById('theme-icon-svg').innerHTML = '<path d="M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 70.5l-58-14.4c-6.8-1.7-12.4-6.6-14.7-13.1l-23.1-64.7c-5-13.9-24.6-13.9-29.6 0l-23.1 64.7c-2.3 6.5-7.9 11.4-14.7 13.1l-68.5 17.1c-13.9 3.5-13.9 23.3 0 26.8l68.5 17.1c6.8 1.7 12.4 6.6 14.7 13.1l23.1 64.7c5 13.9 24.6 13.9 29.6 0l23.1-64.7c2.3-6.5 7.9-11.4 14.7-13.1l58-14.4c13.8-3.5 13.8-23.3 0-26.8z"/>';
        } else {
            document.body.classList.remove('dark-theme');
            document.getElementById('nav-logo-img').src = "agb-logo-png.png";
            document.getElementById('welcome-logo-img').src = "agb-logo-png.png";
            document.getElementById('theme-icon-svg').innerHTML = '<path d="M223.5 32C100 32 0 132.3 0 256s100 224 223.5 224c60.6 0 115.5-24.2 155.8-63.4 5-4.9 6.3-12.5 3.1-18.7s-10.1-9.7-17-8.5c-9.8 1.7-19.8 2.6-30.1 2.6-96.9 0-175.5-78.8-175.5-176 0-65.8 36-123.1 89.3-153.3 6.1-3.5 9.2-10.5 7.7-17.3s-7.3-11.9-14.3-12.5c-6.3-.5-12.6-.8-19-.8z"/>';
        }

        document.getElementById('welcome-name').innerText = t.name;
        document.getElementById('welcome-tagline').innerText = t.tagline;
        document.getElementById('welcome-btn').innerText = t.welcomeBtn; 
        document.getElementById('main-name').innerText = t.name;
        document.getElementById('about-me').innerHTML = t.about;
        document.getElementById('title-journey').innerText = t.journey;
        document.getElementById('title-expertise').innerText = t.expertise;
        document.getElementById('title-projects').innerText = t.projects;
        document.getElementById('title-ratings').innerText = t.ratings;
        document.getElementById('step1').innerText = t.step1;
        document.getElementById('step2').innerText = t.step2;
        document.getElementById('step3').innerText = t.step3;
        document.getElementById('step4').innerText = t.step4;
        document.getElementById('step5').innerText = t.step5;
        document.getElementById('skill3').innerText = t.skill3;
        document.getElementById('skill4').innerText = t.skill4;
        document.getElementById('skill6').innerText = t.skill6;
        document.getElementById('p1-title').innerText = projectData.hr[currentLang].title;
        document.getElementById('p2-title').innerText = projectData.sales[currentLang].title;
        document.getElementById('p1-btn').innerText = t.viewBtn;
        document.getElementById('p2-btn').innerText = t.viewBtn;
        document.getElementById('back-btn').innerText = t.back;
        document.getElementById('view-ratings-text').innerText = t.viewRatings;

        document.querySelectorAll('.flag-btn').forEach(f => f.classList.remove('active'));
        if(document.getElementById('lang-' + currentLang)) document.getElementById('lang-' + currentLang).classList.add('active');
    }

    function setLang(lang) { currentLang = lang; localStorage.setItem('ahmedLang', lang); jobIdx = 0; charIdx = 0; updateUI(); }
    function toggleDarkMode() { isDarkMode = !isDarkMode; localStorage.setItem('ahmedDarkMode', isDarkMode); updateUI(); }

    function startExploring() {
        const overlay = document.getElementById('welcome-overlay');
        overlay.classList.add('slide-up');
        setTimeout(() => { 
            overlay.style.display = 'none'; 
            const main = document.getElementById('main-site'); 
            main.style.display = 'block'; 
            setTimeout(() => { main.style.opacity = '1'; startTypingEffect(); }, 50); 
            updateUI();
        }, 1000);
    }

    function showJourney(id) {
        lastScrollPos = window.scrollY;
        const d = journeyData[id][currentLang];
        document.getElementById('case-header-content').innerHTML = `
            <div class="case-header">
                <h2>${d.title}</h2>
                <p style="font-size:18px; line-height:1.8; color:var(--text-gray);">${d.desc}</p>
            </div>`;
        document.getElementById('study-images').innerHTML = "";
        document.getElementById('main-site').style.display = 'none';
        document.getElementById('case-study-view').style.display = 'block';
        window.scrollTo(0,0);
    }

    function showStudy(id) {
        lastScrollPos = window.scrollY;
        const d = projectData[id][currentLang];
        const t = translations[currentLang];
        const imgs = projectData[id].imgs.map(src => `<img src="${src}" style="width:100%; margin-bottom:20px; border-radius:15px;">`).join('');
        document.getElementById('case-header-content').innerHTML = `
            <div class="case-header">
                <h2>${d.title}</h2>
                <p><b>${t.obj}:</b> ${d.o}</p>
                <div class="detail-grid">
                    <div><b style="color:var(--main-blue)">${t.ch}</b><br>${d.c}</div>
                    <div><b style="color:var(--main-blue)">${t.sol}</b><br>${d.s}</div>
                    <div><b style="color:var(--main-blue)">${t.imp}</b><br>${d.i}</div>
                    <div><b style="color:var(--main-blue)">${t.tool}</b><br>${d.t}</div>
                </div>
            </div>`;
        document.getElementById('study-images').innerHTML = imgs;
        document.getElementById('main-site').style.display = 'none';
        document.getElementById('case-study-view').style.display = 'block';
        window.scrollTo(0,0);
    }

    function hideStudy() { document.getElementById('case-study-view').style.display = 'none'; document.getElementById('main-site').style.display = 'block'; window.scrollTo(0, lastScrollPos); }

    function openRatingsPage() {
        lastScrollPos = window.scrollY;
        const t = translations[currentLang];
        const ratingsHtml = `
            <div class="rating-input-section">
                <h4>${t.ratePrompt}</h4>
                <div class="stars" id="star-rating">
                    ${[1,2,3,4,5].map(v => `<svg class="star-svg-input active" data-value="${v}" onclick="setRating(${v})" viewBox="0 0 576 512"><path d="M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z"/></svg>`).join('')}
                </div>
                <div id="rating-form">
                    <input type="text" id="user-name" class="rating-input" placeholder="${t.namePlace}"><br>
                    <textarea id="user-comment" class="rating-input" rows="3" placeholder="${t.ratePlace}"></textarea><br>
                    <button class="submit-rate-btn" onclick="submitRating()">${t.rateBtn}</button>
                </div>
            </div>
            <div class="grid-container" id="ratings-display-inner"><p class="loading-text">${t.loading}</p></div>`;
        document.getElementById('case-header-content').innerHTML = ratingsHtml;
        document.getElementById('study-images').innerHTML = "";
        document.getElementById('main-site').style.display = 'none';
        document.getElementById('case-study-view').style.display = 'block';
        window.scrollTo(0,0);
        fetchReviews();
    }

    function setRating(val) {
        selectedRating = val;
        document.querySelectorAll('.star-svg-input').forEach(star => star.classList.toggle('active', star.getAttribute('data-value') <= val));
    }

    function fetchReviews() {
        fetch(SHEETDB_URL).then(res => res.json()).then(data => {
            const container = document.getElementById('ratings-display-inner');
            container.innerHTML = "";
            data.reverse().forEach(rev => {
                const card = document.createElement('div');
                card.className = "expertise-box reveal active"; card.style.maxWidth = "100%";
                const isAr = /[\u0600-\u06FF]/.test(rev.Feedback); card.style.textAlign = isAr ? 'right' : 'left';
                let starsText = '★'.repeat(rev.Rating || 5) + '☆'.repeat(5 - (rev.Rating || 5));
                card.innerHTML = `<strong style="display:block; color:var(--main-blue);">${rev.Name}</strong><p style="font-style: italic; font-size: 14px; margin: 5px 0;">${rev.Feedback}</p><div style="color: #ffce00;">${starsText}</div>`;
                container.appendChild(card);
            });
        });
    }

    function submitRating() {
        const name = document.getElementById('user-name').value;
        const comment = document.getElementById('user-comment').value;
        const t = translations[currentLang];
        if (!name || !comment) { alert(t.alert); return; }
        fetch(SHEETDB_URL, {
            method: 'POST', headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ data: [{ Name: name, Feedback: comment, Rating: selectedRating, Date: new Date().toLocaleDateString() }] })
        }).then(() => { alert(t.thanks); openRatingsPage(); });
    }

    window.addEventListener('scroll', () => {
        document.querySelectorAll('.reveal').forEach(el => {
            if (el.getBoundingClientRect().top < window.innerHeight - 50) el.classList.add('active');
        });
    });

    window.onload = updateUI;
</script><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ahmed Gharib | AGBINSIGHTS</title>
    
    <link rel="icon" type="image/png" href="agb-logo.png.1.jpeg">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root { 
            --main-blue: #4a90e2; 
            --bg-white: #ffffff; 
            --deep-black: #000000;
            --text-gray: #555555; 
            --glow-effect: 0 4px 15px rgba(74, 144, 226, 0.2);
            --footer-black: transparent; 
        }

       body { background-color: var(--bg-white); color: var(--deep-black); font-family: 'Inter', sans-serif; margin: 0; text-align: center; scroll-behavior: smooth; overflow-x: hidden; }
       body.rtl { direction: rtl; font-family: 'Cairo', sans-serif; }
       
        #welcome-overlay { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: var(--bg-white);
            display: flex; align-items: center; justify-content: center; 
            z-index: 10000; transition: 1s cubic-bezier(0.85, 0, 0.15, 1); 
        }
        
        #welcome-overlay.slide-up {
            transform: translateY(-100%);
        }

        .welcome-box { text-align: center; padding: 20px; }
        .welcome-logo { width: 120px; height: 120px; margin-bottom: 25px; border-radius: 50%; border: 3px solid var(--main-blue); transition: 0.3s; object-fit: contain; }
        
        .start-btn { 
            background: var(--main-blue); color: white; padding: 15px 40px; 
            border: none; border-radius: 50px; font-weight: 900; cursor: pointer; 
            margin-top: 30px; text-transform: uppercase; letter-spacing: 2px;
            box-shadow: 0 4px 15px rgba(74, 144, 226, 0.3);
        }

        #main-site { opacity: 0; display: none; }
        
        nav { 
            width: 100%; 
            padding: 10px 5%; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            background: var(--bg-white);
            position: sticky; 
            top: 0; 
            z-index: 1000;
            box-sizing: border-box;
            direction: ltr !important;
        }

        .nav-brand { display: flex; align-items: center; gap: 10px; }
        .nav-logo-img { height: 80px; width: auto; transition: 0.4s ease; cursor: pointer; mix-blend-mode: multiply; filter: contrast(1.1); }
        .nav-logo-img:hover { transform: scale(1.1); }
        
        body.dark-theme .nav-logo-img, body.dark-theme .welcome-logo { 
            filter: none; 
            mix-blend-mode: normal; 
        }

        .lang-switch { display: flex; gap: 12px; align-items: center; }
        .flag-btn { 
            width: 32px !important; 
            height: 32px !important; 
            cursor: pointer; 
            border-radius: 50% !important; 
            opacity: 0.8; 
            transition: 0.3s; 
            object-fit: cover !important; 
            border: 2px solid transparent !important;
        }

        #dark-mode-toggle {
            cursor: pointer;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: 0.3s;
        }
        #dark-mode-toggle svg {
            width: 22px;
            height: 22px;
            fill: var(--main-blue);
        }

        .flag-btn.active { 
            opacity: 1 !important; 
            border: 2px solid var(--main-blue) !important; 
            transform: scale(1.15);
        }

        header { padding: 60px 20px; text-align: center; }
        h1 { font-size: clamp(35px, 8vw, 75px); margin: 0; font-weight: 900; }
        
        .job-tag { 
            color: var(--main-blue); 
            font-size: 16px; 
            letter-spacing: 3px; 
            font-weight: 700; 
            text-transform: uppercase; 
            display: inline-block; 
            margin-top: 10px; 
            min-height: 1.2em;
        }
        .job-tag::after { content: "|"; animation: blink 0.7s infinite; }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }

        .about-text { 
            max-width: 800px; 
            margin: 25px auto; 
            color: var(--text-gray); 
            font-size: 17px; 
            line-height: 1.6; 
            padding: 0 20px;
            border-left: 3px solid var(--main-blue);
        }
        body.rtl .about-text { border-left: none; border-right: 3px solid var(--main-blue); }

        .section-title { 
            text-align: left; margin: 40px 0 20px 10%; color: var(--deep-black); 
            border-left: 5px solid var(--main-blue); padding-left: 15px; 
            font-weight: bold; font-size: 24px;
        }
        body.rtl .section-title { text-align: right; border-left: none; border-right: 5px solid var(--main-blue); padding-left: 0; padding-right: 15px; margin: 40px 10% 20px 0; }

        .grid-container { 
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 20px;
            padding: 0 10%;
            margin-bottom: 40px;
        }

        .expertise-box { 
            background: var(--bg-white); 
            border: 1px solid #eee; 
            padding: 25px 15px; 
            border-radius: 15px; 
            transition: all 0.3s ease; 
            cursor: default; 
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .expertise-box:hover {
            transform: translateY(-10px);
            box-shadow: 0 10px 20px rgba(74, 144, 226, 0.15);
            background: #fcfcfc;
            border-color: var(--main-blue);
        }

        .expertise-box svg {
            width: 45px;
            height: 45px;
            margin-bottom: 15px;
            fill: var(--main-blue);
            transition: 0.3s;
        }

        .expertise-box p {
            margin: 0;
            font-weight: bold;
            font-size: 15px;
            color: var(--deep-black);
        }

        .process-flow { 
            display: flex; 
            justify-content: center; 
            gap: 15px; 
            flex-wrap: wrap; 
            padding: 0 10%; 
            margin-bottom: 40px; 
        }
        .process-step { 
            background: var(--bg-white); 
            border: 1px solid #eee; 
            padding: 25px 15px; 
            flex: 1 1 130px; 
            max-width: 200px;
            border-radius: 15px; 
            transition: all 0.3s ease; 
            cursor: pointer; 
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        /* ضبط أيقونات الـ Journey */
        .process-step svg { 
            width: 32px; 
            height: 32px; 
            fill: var(--main-blue); 
            margin-bottom: 15px; 
        }
        
        .process-step:hover { transform: translateY(-5px); border-color: var(--main-blue); box-shadow: 0 10px 20px rgba(74, 144, 226, 0.1); }

        @media (max-width: 480px) {
            .grid-container, .process-flow {
                padding: 0 15px !important; 
                gap: 12px !important;
                display: grid !important;
                grid-template-columns: repeat(2, 1fr) !important;
            }
            .expertise-box, .process-step {
                max-width: 100% !important;
                padding: 20px 10px !important;
            }
        }

        .projects-wrapper { 
            display: flex; 
            flex-direction: column; 
            gap: 40px; 
            padding: 0 10%; 
        }
        .project-item { 
            display: flex; 
            flex-direction: column; 
            background: var(--bg-white); 
            border: 1px solid #eee; 
            border-radius: 20px; 
            overflow: hidden; 
            width: 100%; 
        }
        .p-img { width: 100%; line-height: 0; }
        .p-img img { width: 100%; height: auto; display: block; object-fit: cover; }
        .p-text { width: 100%; padding: 30px; box-sizing: border-box; text-align: center; }

        @media (min-width: 768px) {
            .project-item { flex-direction: row; align-items: stretch; }
            .p-img { width: 60%; } 
            .p-text { width: 40%; padding: 40px; display: flex; flex-direction: column; justify-content: center; text-align: left; }
            body.rtl .p-text { text-align: right; }
        }

        .btn-view { border: 2px solid var(--main-blue); color: var(--main-blue); padding: 12px 30px; border-radius: 10px; cursor: pointer; display: inline-block; margin-top: 20px; font-weight: 800; transition: 0.3s; }
        .btn-view:hover { background: var(--main-blue); color: #fff; }
        
        #case-study-view { display:none; background: var(--bg-white); padding: 40px 10%; text-align: left; }
        body.rtl #case-study-view { text-align: right; }
        .case-header { background: #f9f9f9; padding: 30px; border-radius: 20px; border-left: 6px solid var(--main-blue); margin-bottom: 30px; }
        body.rtl .case-header { border-left: none; border-right: 6px solid var(--main-blue); }
        .detail-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px; }

        .rating-input-section { margin-bottom: 30px; padding: 30px; background: #f9f9f9; border-radius: 20px; text-align: center; }
        .stars { font-size: 24px; margin-bottom: 10px; cursor: pointer; display: flex; justify-content: center; gap: 5px; }
        .star-svg-input { width: 25px; height: 25px; fill: #ccc; transition: 0.2s; }
        .star-svg-input.active { fill: #ffce00; }

        .rating-input { width: 100%; max-width: 400px; padding: 12px; border: 1px solid #ddd; border-radius: 10px; margin-bottom: 10px; font-family: inherit; }
        .submit-rate-btn { background: var(--main-blue); color: white; border: none; padding: 10px 25px; border-radius: 8px; cursor: pointer; font-weight: bold; }

        footer { 
            padding: 60px 20px; 
            background: transparent; 
            color: var(--deep-black); 
            margin-top: 50px; 
            transition: 0.3s;
        }
        .social-icons { display: flex; justify-content: center; gap: 20px; }
        .social-icons a { color: var(--deep-black); transition: 0.3s; text-decoration: none; }
        .social-icons svg { width: 30px; height: 30px; fill: var(--deep-black); }
        .social-icons a:hover { transform: translateY(-3px); }
        .social-icons a:hover svg { fill: var(--main-blue); }

        body.dark-theme { --bg-white: #111111; --deep-black: #ffffff; --text-gray: #bbbbbb; }
        body.dark-theme nav { background: #000000; } 
        body.dark-theme .expertise-box, body.dark-theme .process-step, body.dark-theme .project-item, body.dark-theme .case-header, body.dark-theme .rating-input-section { background: #000000; border-color: #222; }
        body.dark-theme .social-icons svg { fill: #ffffff; }

        .reveal { opacity: 0; transform: translateY(30px); transition: all 0.8s ease-out; }
        .reveal.active { opacity: 1; transform: translateY(0); }
    </style>
</head>
<body>

<div id="welcome-overlay">
    <div class="welcome-box">
       <img src="agb-logo-png.png" class="welcome-logo" id="welcome-logo-img">
       <h2 id="welcome-name">Ahmed Gharib</h2>
       <p id="welcome-tagline">Turning Complex Data into Strategic Assets</p>
       <button class="start-btn" onclick="startExploring()" id="welcome-btn">Explore Insights</button>
    </div>
</div>

<div id="main-site">
    <nav>
        <div class="nav-brand">
            <img src="agb-logo-png.png" class="nav-logo-img" id="nav-logo-img" onclick="location.reload()">
        </div>
        <div class="lang-switch">
            <img src="https://flagcdn.com/w40/gb.png" class="flag-btn" id="lang-en" onclick="setLang('en')" title="English">
            <img src="https://flagcdn.com/w40/eg.png" class="flag-btn" id="lang-ar" onclick="setLang('ar')" title="العربية">
            <img src="https://flagcdn.com/w40/es.png" class="flag-btn" id="lang-es" onclick="setLang('es')" title="Español">
            <div id="dark-mode-toggle" onclick="toggleDarkMode()">
                <svg id="theme-icon-svg" viewBox="0 0 512 512"></svg>
            </div>
        </div>
    </nav>

    <header>
        <h1 id="main-name">Ahmed Gharib</h1>
        <span class="job-tag" id="job-title"></span>
        <p class="about-text" id="about-me"></p>
    </header>

    <div class="section-title" id="title-journey"></div>
    <div class="process-flow">
        <div class="process-step reveal" onclick="showJourney('understand')">
            <svg viewBox="0 0 512 512"><path d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM216 336h40V272H216V240h72v96h40v32H216V336zM256 160a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"/></svg>
            <h4 id="step1"></h4>
        </div>
        <div class="process-step reveal" onclick="showJourney('extract')">
            <svg viewBox="0 0 448 512"><path d="M208 0H332.1c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9V336c0 26.5-21.5 48-48 48H208c-26.5 0-48-21.5-48-48V48c0-26.5 21.5-48 48-48zM48 128h80v64H48V448H256V384h64v64c0 35.3-28.7 64-64 64H48c-35.3 0-64-28.7-64-64V192c0-35.3 28.7-64 64-64z"/></svg>
            <h4 id="step2"></h4>
        </div>
        <div class="process-step reveal" onclick="showJourney('clean')">
            <svg viewBox="0 0 512 512"><path d="M4.1 38.2C1.4 34.2 0 29.4 0 24.5C0 11 11 0 24.5 0H198.2c16.3 0 31.2 9.2 38.4 23.8L272 96h192c26.5 0 48 21.5 48 48V464c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V48c0-3.3 .3-6.6 1-9.8z"/></svg>
            <h4 id="step3"></h4>
        </div>
        <div class="process-step reveal" onclick="showJourney('model')">
            <svg viewBox="0 0 448 512"><path d="M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z"/></svg>
            <h4 id="step4"></h4>
        </div>
        <div class="process-step reveal" onclick="showJourney('insight')">
            <svg viewBox="0 0 352 512"><path d="M176 0c-44.2 0-80 35.8-80 80c0 4.4 .4 8.8 1.1 13l-48.4 48.4c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l48.4-48.4c4.2 .7 8.6 1.1 13 1.1c44.2 0 80-35.8 80-80s-35.8-80-80-80zm0 112a32 32 0 1 1 0-64 32 32 0 1 1 0 64zM48 224h16v32H48c-8.8 0-16 7.2-16 16v144c0 8.8 7.2 16 16 16h256c8.8 0 16-7.2 16-16V288c0-8.8-7.2-16-16-16h-16V224h16c26.5 0 48 21.5 48 48v144c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V272c0-26.5 21.5-48 48-48z"/></svg>
            <h4 id="step5"></h4>
        </div>
    </div>

    <div class="section-title" id="title-expertise"></div>
    <div class="grid-container"> 
        <div class="expertise-box reveal">
            <svg viewBox="0 0 512 512"><path d="M32 32c17.7 0 32 14.3 32 32V400c0 8.8 7.2 16 16 16H480c17.7 0 32 14.3 32 32s-14.3 32-32 32H80c-44.2 0-80-35.8-80-80V64C0 46.3 14.3 32 32 32zM160 224c17.7 0 32 14.3 32 32v64c0 17.7-14.3 32-32 32s-32-14.3-32-32V256c0-17.7 14.3-32 32-32zm128-64c17.7 0 32 14.3 32 32v128c0 17.7-14.3 32-32 32s-32-14.3-32-32V192c0-17.7 14.3-32 32-32zm128-64c17.7 0 32 14.3 32 32v192c0 17.7-14.3 32-32 32s-32-14.3-32-32V128c0-17.7 14.3-32 32-32z"/></svg>
            <p>Power BI</p>
        </div>
        <div class="expertise-box reveal">
            <svg viewBox="0 0 384 512"><path d="M64 0C28.7 0 0 28.7 0 64V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V160H256c-17.7 0-32-14.3-32-32V0H64zM256 0V128H384L256 0zM128 224l32 32 32-32c12.5-12.5 32.8-12.5 45.3 0s12.5 32.8 0 45.3L205.3 304l32 32c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L160 349.3l-32 32c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l32-32L82.7 269.3c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0z"/></svg>
            <p>Excel</p>
        </div>
        <div class="expertise-box reveal">
            <svg viewBox="0 0 448 512"><path d="M448 80v48c0 44.2-100.3 80-224 80S0 172.2 0 128V80C0 35.8 100.3 0 224 0S448 35.8 448 80zM393.2 214.7c20.8-7.4 39.9-16.9 54.8-28.7V288c0 44.2-100.3 80-224 80S0 332.2 0 288V186c14.9 11.8 34 21.2 54.8 28.7C99.7 230.5 159.3 240 224 240s124.3-9.5 169.2-25.3zM0 346c14.9 11.8 34 21.2 54.8 28.7C99.7 390.5 159.3 400 224 400s124.3-9.5 169.2-25.3c20.8-7.4 39.9-16.9 54.8-28.7V432c0 44.2-100.3 80-224 80S0 476.2 0 432V346z"/></svg>
            <p id="skill3"></p>
        </div>
        <div class="expertise-box reveal">
            <svg viewBox="0 0 640 512"><path d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6zm80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3L562.7 256l-89.3 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L165.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0z"/></svg>
            <p id="skill4"></p>
        </div>
        <div class="expertise-box reveal">
            <svg viewBox="0 0 512 512"><path d="M3.9 54.9C10.5 40.9 24.5 32 40 32H472c15.5 0 29.5 8.9 36.1 22.9s4.6 30.5-5.2 42.5L320 320.9V448c0 12.1-6.8 23.2-17.7 28.6l-128 64c-11.3 5.6-24.9 4.4-35.1-3.1S128 516.1 128 504V320.9L3.9 97.5C-5.9 85.5-6.5 68.8 3.9 54.9z"/></svg>
            <p>ETL</p>
        </div>
        <div class="expertise-box reveal">
            <svg viewBox="0 0 576 512"><path d="M288 32c-80.8 0-145.5 64.7-145.5 145.5 0 26.5 7.1 51.3 19.6 72.7L32 480h46.3l61.2-103.7c20.5 13.7 45 21.7 71.5 21.7 80.8 0 145.5-64.7 145.5-145.5S368.8 32 288 32zm0 244.1c-54.4 0-98.6-44.2-98.6-98.6s44.2-98.6 98.6-98.6 98.6 44.2 98.6 98.6-44.1 98.6-98.6 98.6zM544 480l-91.4-154.9c13.7-20.5 21.7-45 21.7-71.5 0-80.8-64.7-145.5-145.5-145.5-26.5 0-51.3 7.1-72.7 19.6L497.7 480H544z"/></svg>
            <p id="skill6"></p>
        </div>
    </div>

    <div class="section-title" id="title-projects"></div>
    <div class="projects-wrapper">
        <div class="project-item reveal"> 
            <div class="p-img"><img src="hr.png.png"></div>
            <div class="p-text">
                <h3 id="p1-title"></h3>
                <div class="btn-view" onclick="showStudy('hr')" id="p1-btn"></div>
            </div>
        </div>
        <div class="project-item reveal">
            <div class="p-img"><img src="sales.png1.png"></div>
            <div class="p-text">
                <h3 id="p2-title"></h3>
                <div class="btn-view" onclick="showStudy('sales')" id="p2-btn"></div>
            </div>
        </div>
    </div>

    <div class="section-title" id="title-ratings"></div>
    <div class="grid-container" style="display: flex; justify-content: center;">
        <div class="expertise-box reveal" onclick="openRatingsPage()" style="cursor: pointer; min-width: 250px;">
            <svg style="width:32px; height:32px; fill:#ffce00; margin-bottom:10px;" viewBox="0 0 576 512"><path d="M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z"/></svg>
            <p id="view-ratings-text"></p>
        </div>
    </div>

    <footer>
        <div class="social-icons">
            <a href="https://www.linkedin.com/in/ahmed-gharib-20989a272/" target="_blank">
                <svg viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
            </a>
            <a href="mailto:info@agbinsights.com">
                <svg viewBox="0 0 512 512"><path d="M64 112c-8.8 0-16 7.2-16 16v22.1L220.5 291.7c20.7 17 50.4 17 71.1 0L464 150.1V128c0-8.8-7.2-16-16-16H64zM48 212.2V384c0 8.8 7.2 16 16 16H448c8.8 0 16-7.2 16-16V212.2L322 328.8c-38.4 31.5-93.7 31.5-132 0L48 212.2zM0 128C0 92.7 28.7 64 64 64H448c35.3 0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V128z"/></svg>
            </a>
        </div>
        <p style="margin-top: 20px; opacity: 0.6; font-size: 12px;">©️ AHMED GHARIB | AGBINSIGHTS</p>
    </footer>
</div>

<div id="case-study-view">
    <div onclick="hideStudy()" id="back-btn" style="color:var(--main-blue); cursor:pointer; margin-bottom:30px; font-weight:bold;"></div>
    <div id="case-header-content"></div>
    <div id="study-images"></div>
</div>

<script>
    let currentLang = localStorage.getItem('ahmedLang') || 'en';
    let isDarkMode = localStorage.getItem('ahmedDarkMode') === 'true';
    let lastScrollPos = 0;
    let selectedRating = 5;
    const SHEETDB_URL = 'https://sheetdb.io/api/v1/jv44e0ygedwit';

    const translations = {
        en: {
            name: "Ahmed Gharib", welcomeBtn: "Explore Insights", 
            tagline: "Turning Complex Data into Actionable Insights",
            about: "I help organizations make sense of their data by converting complex datasets into clear, actionable insights. Through data analysis and visualization, I support better decisions, performance improvement, and measurable business results.",
            journey: "01. Journey", expertise: "02. Expertise", projects: "03. Projects", ratings: "04. Ratings",
            step1: "Understand", step2: "Extract", step3: "Clean", step4: "Model", step5: "Insight",
            skill3: "Modeling", skill4: "DAX Logic", skill6: "Viz",
            viewBtn: "View Details", back: "← BACK TO HOME",
            obj: "OBJECTIVE", ch: "CHALLENGE", sol: "SOLUTION", imp: "IMPACT", tool: "TOOLS",
            ratePrompt: "Leave a Review", namePlace: "Name", ratePlace: "Write your feedback...", rateBtn: "Submit",
            alert: "Please enter both name and comment", thanks: "Thank you for your feedback!",
            viewRatings: "View & Add Reviews", loading: "Loading reviews..."
        },
        ar: {
            name: "أحمد غريب", welcomeBtn: "استكشاف التفاصيل", 
            tagline: "تحويل البيانات المعقدة إلى رؤى استراتيجية",
            about: "أساعد المؤسسات على فهم بياناتها من خلال تحويل مجموعات البيانات المعقدة إلى رؤى واضحة وقابلة للتنفيذ. من خلال تحليل البيانات والتمثيل المرئي، أدعم اتخاذ قرارات أفضل، وتحسين الأداء، وتحقيق نتائج أعمال ملموسة.",
            journey: "01. الرحلة", expertise: "02. الخبرات", projects: "03. المشاريع", ratings: "04. التقييمات",
            step1: "الفهم", step2: "استخراج", step3: "تنظيف", step4: "نمذجة", step5: "رؤية",
            skill3: "نمذجة", skill4: "منطق DAX", skill6: "تصوير",
            viewBtn: "عرض التفاصيل", back: "← العودة للرئيسية",
            obj: "الهدف", ch: "التحدي", sol: "الحل", imp: "الأثر", tool: "الأدوات",
            ratePrompt: "أضف تقييمك", namePlace: "الاسم", ratePlace: "اكتب رأيك هنا...", rateBtn: "إرسال",
            alert: "يرجى إدخال الاسم والتعليق", thanks: "شكراً لتقييمك!",
            viewRatings: "عرض وإضافة التقييمات", loading: "جاري تحميل التقييمات..."
        },
        es: {
            name: "Ahmed Gharib", welcomeBtn: "Explorar Detalles", 
            tagline: "Convirtiendo Datos Complexos en Perspectivas Accionables",
            about: "Ayudo a las organizaciones a dar sentido a sus datos convirtiendo conjuntos de datos complejos en conocimientos claros y procesables. A través del análisis y la visualización, apoyo mejores decisiones y resultados comerciales mensurables.",
            journey: "01. Trayectoria", expertise: "02. Experiencia", projects: "03. Proyectos", ratings: "04. Valoraciones",
            step1: "Entender", step2: "Extraer", step3: "Limpiar", step4: "Modelar", step5: "Perspectiva",
            skill3: "Modelado", skill4: "Lógica DAX", skill6: "Viz",
            viewBtn: "Ver Detalles", back: "← VOLVER AL INICIO",
            obj: "OBJETIVO", ch: "DESAFÍO", sol: "SOLUCIÓN", imp: "IMPACTO", tool: "HERRAMIENTAS",
            ratePrompt: "Deja una reseña", namePlace: "Nombre", ratePlace: "Escribe tu opinión...", rateBtn: "Enviar",
            alert: "Por favor, introduzca su nombre y comentario", thanks: "¡Gracias por tu comentario!",
            viewRatings: "Ver y añadir reseñas", loading: "Cargando reseñas..."
        }
    };

    const typingJobs = {
        en: ["Data Analyst", "Power BI Specialist", "Problem Solver", "Insights Explorer"],
        ar: ["محلل بيانات", "خبير Power BI", "محلل مشكلات", "مستكشف رؤى"],
        es: ["Analista de Datos", "Especialista en Power BI", "Analista de Problemas"]
    };

    let jobIdx = 0;
    let charIdx = 0;
    let isDeleting = false;

    function startTypingEffect() {
        const currentJobs = typingJobs[currentLang];
        const target = document.getElementById('job-title');
        if(!target) return;
        
        const fullText = currentJobs[jobIdx];
        if (isDeleting) { target.innerText = fullText.substring(0, charIdx - 1); charIdx--; }
        else { target.innerText = fullText.substring(0, charIdx + 1); charIdx++; }

        let speed = isDeleting ? 50 : 150;
        if (!isDeleting && charIdx === fullText.length) { isDeleting = true; speed = 2000; }
        else if (isDeleting && charIdx === 0) { isDeleting = false; jobIdx = (jobIdx + 1) % currentJobs.length; speed = 500; }
        setTimeout(startTypingEffect, speed);
    }

    const journeyData = {
        understand: {
            en: { title: "Understand Business Needs", desc: "Defining clear objectives and understanding KPIs critical to business success." },
            ar: { title: "فهم احتياجات العمل", desc: "تحديد أهداف واضحة وفهم مؤشرات الأداء الرئيسية (KPIs) الضرورية لنجاح الأعمال." },
            es: { title: "Entender el Negocio", desc: "Definición de objetivos claros y comprensión de los indicadores clave de rendimiento (KPI)." }
        },
        extract: {
            en: { title: "Data Extraction", desc: "Connecting to various data sources to gather the raw information needed for analysis." },
            ar: { title: "استخراج البيانات", desc: "الاتصال بمصادر البيانات المختلفة لجمع المعلومات الخام المطلوبة للتحليل." },
            es: { title: "Extracción de Datos", desc: "Conexión a diversas fuentes de datos para recopilar la información necesaria." }
        },
        clean: {
            en: { title: "Data Cleaning & Transformation", desc: "Using Power Query to remove duplicates, fix errors, and transform data." },
            ar: { title: "تنظيف وتحويل البيانات", desc: "استخدام Power Query لإزالة التكرارات، وإصلاح الأخطاء، وتحويل البيانات." },
            es: { title: "Limpieza de Datos", desc: "Uso de Power Query para eliminar duplicados, corregir errores y transformar los datos." }
        },
        model: {
            en: { title: "Data Modeling & DAX", desc: "Creating relationships between tables and writing DAX formulas." },
            ar: { title: "نمذجة البيانات و DAX", desc: "إنشاء العلاقات بين الجداول وكتابة صيغ DAX لحساب مقاييس الأعمال المعقدة." },
            es: { title: "Modelado y DAX", desc: "Creación de relaciones entre tablas y escritura de fórmulas DAX." }
        },
        insight: {
            en: { title: "Insights & Visualization", desc: "Designing intuitive dashboards that tell a story and help decision-makers." },
            ar: { title: "الرؤى والتمثيل المرئي", desc: "تصميم لوحات بيانات بديهية تحكي قصة البيانات وتساعد صناع القرار." },
            es: { title: "Perspectivas y Visualización", desc: "Diseño de cuadros de mando intuitivos que cuentan una historia." }
        }
    };

    const projectData = {
        hr: { 
            en: { title: "HR Attrition Analysis", o: "Identify factors behind turnover.", c: "High turnover rates.", s: "Power BI dashboard with DAX.", i: "15% reduction opportunity.", t: "Power BI, DAX" },
            ar: { title: "تحليل استقالات الموظفين", o: "تحديد أسباب ترك العمل.", c: "معدلات دوران عالية.", s: "لوحة بيانات Power BI.", i: "فرصة تقليل 15%.", t: "Power BI, DAX" },
            es: { title: "Análisis de Rotación", o: "Identificar factores.", c: "Alta rotación.", s: "Dashboard Power BI.", i: "Mejora del 15%.", t: "Power BI, DAX" },
            imgs: ['hr.png.png', 'hr.png2.png', 'hr.png3.png']
        },
        sales: {
            en: { title: "Sales Performance Hub", o: "Centralize sales data.", c: "Fragmented data.", s: "Unified ETL pipeline.", i: "40% faster reporting.", t: "Excel, Power BI" },
            ar: { title: "مركز أداء المبيعات", o: "مركزية البيانات.", c: "بيانات مشتتة.", s: "مسار ETL موحد.", i: "سرعة تقارير 40%.", t: "Excel, Power BI" },
            es: { title: "Hub de Ventas", o: "Centralizar datos.", c: "Datos fragmentados.", s: "Pipeline ETL.", i: "40% más rápido.", t: "Excel, Power BI" },
            imgs: ['sales.png1.png', 'sales.png2.png', 'sales.png3.png']
        }
    };

    function updateUI() {
        const t = translations[currentLang];
        document.body.className = currentLang === 'ar' ? 'rtl' : '';
        if (isDarkMode) {
            document.body.classList.add('dark-theme');
            document.getElementById('nav-logo-img').src = "agb-logo.png.1.jpeg";
            document.getElementById('welcome-logo-img').src = "agb-logo.png.1.jpeg";
            document.getElementById('theme-icon-svg').innerHTML = '<path d="M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 70.5l-58-14.4c-6.8-1.7-12.4-6.6-14.7-13.1l-23.1-64.7c-5-13.9-24.6-13.9-29.6 0l-23.1 64.7c-2.3 6.5-7.9 11.4-14.7 13.1l-68.5 17.1c-13.9 3.5-13.9 23.3 0 26.8l68.5 17.1c6.8 1.7 12.4 6.6 14.7 13.1l23.1 64.7c5 13.9 24.6 13.9 29.6 0l23.1-64.7c2.3-6.5 7.9-11.4 14.7-13.1l58-14.4c13.8-3.5 13.8-23.3 0-26.8z"/>';
        } else {
            document.body.classList.remove('dark-theme');
            document.getElementById('nav-logo-img').src = "agb-logo-png.png";
            document.getElementById('welcome-logo-img').src = "agb-logo-png.png";
            document.getElementById('theme-icon-svg').innerHTML = '<path d="M223.5 32C100 32 0 132.3 0 256s100 224 223.5 224c60.6 0 115.5-24.2 155.8-63.4 5-4.9 6.3-12.5 3.1-18.7s-10.1-9.7-17-8.5c-9.8 1.7-19.8 2.6-30.1 2.6-96.9 0-175.5-78.8-175.5-176 0-65.8 36-123.1 89.3-153.3 6.1-3.5 9.2-10.5 7.7-17.3s-7.3-11.9-14.3-12.5c-6.3-.5-12.6-.8-19-.8z"/>';
        }

        document.getElementById('welcome-name').innerText = t.name;
        document.getElementById('welcome-tagline').innerText = t.tagline;
        document.getElementById('welcome-btn').innerText = t.welcomeBtn; 
        document.getElementById('main-name').innerText = t.name;
        document.getElementById('about-me').innerHTML = t.about;
        document.getElementById('title-journey').innerText = t.journey;
        document.getElementById('title-expertise').innerText = t.expertise;
        document.getElementById('title-projects').innerText = t.projects;
        document.getElementById('title-ratings').innerText = t.ratings;
        document.getElementById('step1').innerText = t.step1;
        document.getElementById('step2').innerText = t.step2;
        document.getElementById('step3').innerText = t.step3;
        document.getElementById('step4').innerText = t.step4;
        document.getElementById('step5').innerText = t.step5;
        document.getElementById('skill3').innerText = t.skill3;
        document.getElementById('skill4').innerText = t.skill4;
        document.getElementById('skill6').innerText = t.skill6;
        document.getElementById('p1-title').innerText = projectData.hr[currentLang].title;
        document.getElementById('p2-title').innerText = projectData.sales[currentLang].title;
        document.getElementById('p1-btn').innerText = t.viewBtn;
        document.getElementById('p2-btn').innerText = t.viewBtn;
        document.getElementById('back-btn').innerText = t.back;
        document.getElementById('view-ratings-text').innerText = t.viewRatings;

        document.querySelectorAll('.flag-btn').forEach(f => f.classList.remove('active'));
        if(document.getElementById('lang-' + currentLang)) document.getElementById('lang-' + currentLang).classList.add('active');
    }

    function setLang(lang) { currentLang = lang; localStorage.setItem('ahmedLang', lang); jobIdx = 0; charIdx = 0; updateUI(); }
    function toggleDarkMode() { isDarkMode = !isDarkMode; localStorage.setItem('ahmedDarkMode', isDarkMode); updateUI(); }

    function startExploring() {
        const overlay = document.getElementById('welcome-overlay');
        overlay.classList.add('slide-up');
        setTimeout(() => { 
            overlay.style.display = 'none'; 
            const main = document.getElementById('main-site'); 
            main.style.display = 'block'; 
            setTimeout(() => { main.style.opacity = '1'; startTypingEffect(); }, 50); 
            updateUI();
        }, 1000);
    }

    function showJourney(id) {
        lastScrollPos = window.scrollY;
        const d = journeyData[id][currentLang];
        document.getElementById('case-header-content').innerHTML = `
            <div class="case-header">
                <h2>${d.title}</h2>
                <p style="font-size:18px; line-height:1.8; color:var(--text-gray);">${d.desc}</p>
            </div>`;
        document.getElementById('study-images').innerHTML = "";
        document.getElementById('main-site').style.display = 'none';
        document.getElementById('case-study-view').style.display = 'block';
        window.scrollTo(0,0);
    }

    function showStudy(id) {
        lastScrollPos = window.scrollY;
        const d = projectData[id][currentLang];
        const t = translations[currentLang];
        const imgs = projectData[id].imgs.map(src => `<img src="${src}" style="width:100%; margin-bottom:20px; border-radius:15px;">`).join('');
        document.getElementById('case-header-content').innerHTML = `
            <div class="case-header">
                <h2>${d.title}</h2>
                <p><b>${t.obj}:</b> ${d.o}</p>
                <div class="detail-grid">
                    <div><b style="color:var(--main-blue)">${t.ch}</b><br>${d.c}</div>
                    <div><b style="color:var(--main-blue)">${t.sol}</b><br>${d.s}</div>
                    <div><b style="color:var(--main-blue)">${t.imp}</b><br>${d.i}</div>
                    <div><b style="color:var(--main-blue)">${t.tool}</b><br>${d.t}</div>
                </div>
            </div>`;
        document.getElementById('study-images').innerHTML = imgs;
        document.getElementById('main-site').style.display = 'none';
        document.getElementById('case-study-view').style.display = 'block';
        window.scrollTo(0,0);
    }

    function hideStudy() { document.getElementById('case-study-view').style.display = 'none'; document.getElementById('main-site').style.display = 'block'; window.scrollTo(0, lastScrollPos); }

    function openRatingsPage() {
        lastScrollPos = window.scrollY;
        const t = translations[currentLang];
        const ratingsHtml = `
            <div class="rating-input-section">
                <h4>${t.ratePrompt}</h4>
                <div class="stars" id="star-rating">
                    ${[1,2,3,4,5].map(v => `<svg class="star-svg-input active" data-value="${v}" onclick="setRating(${v})" viewBox="0 0 576 512"><path d="M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z"/></svg>`).join('')}
                </div>
                <div id="rating-form">
                    <input type="text" id="user-name" class="rating-input" placeholder="${t.namePlace}"><br>
                    <textarea id="user-comment" class="rating-input" rows="3" placeholder="${t.ratePlace}"></textarea><br>
                    <button class="submit-rate-btn" onclick="submitRating()">${t.rateBtn}</button>
                </div>
            </div>
            <div class="grid-container" id="ratings-display-inner">
                <p class="loading-text">${t.loading}</p>
            </div>`;
        document.getElementById('case-header-content').innerHTML = ratingsHtml;
        document.getElementById('study-images').innerHTML = "";
        document.getElementById('main-site').style.display = 'none';
        document.getElementById('case-study-view').style.display = 'block';
        window.scrollTo(0,0);
        fetchReviews();
    }

    function setRating(val) {
        selectedRating = val;
        document.querySelectorAll('.star-svg-input').forEach(star => star.classList.toggle('active', star.getAttribute('data-value') <= val));
    }

    function fetchReviews() {
        fetch(SHEETDB_URL).then(res => res.json()).then(data => {
            const container = document.getElementById('ratings-display-inner');
            container.innerHTML = "";
            data.reverse().forEach(rev => {
                const card = document.createElement('div');
                card.className = "expertise-box reveal active"; card.style.maxWidth = "100%"; card.style.flex = "1 1 300px";
                const isAr = /[\u0600-\u06FF]/.test(rev.Feedback); card.setAttribute('dir', isAr ? 'rtl' : 'ltr'); card.style.textAlign = isAr ? 'right' : 'left';
                let starsText = '★'.repeat(rev.Rating || 5) + '☆'.repeat(5 - (rev.Rating || 5));
                card.innerHTML = `<i class="fas fa-quote-left" style="font-size: 15px; color:var(--main-blue); opacity: 0.5; margin-bottom:5px;"></i>
                    <strong style="display:block; color:var(--main-blue);">${rev.Name}</strong>
                    <p style="font-style: italic; font-size: 14px; margin: 5px 0;">${rev.Feedback}</p>
                    <div style="color: #ffce00;">${starsText}</div>`;
                container.appendChild(card);
            });
        });
    }

    function submitRating() {
        const name = document.getElementById('user-name').value;
        const comment = document.getElementById('user-comment').value;
        const t = translations[currentLang];
        if (!name || !comment) { alert(t.alert); return; }
        fetch(SHEETDB_URL, {
            method: 'POST', headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ data: [{ Name: name, Feedback: comment, Rating: selectedRating, Date: new Date().toLocaleDateString() }] })
        }).then(() => { alert(t.thanks); openRatingsPage(); });
    }

    window.addEventListener('scroll', () => {
        document.querySelectorAll('.reveal').forEach(el => {
            if (el.getBoundingClientRect().top < window.innerHeight - 50) el.classList.add('active');
        });
    });

    window.onload = updateUI;
</script>

</body>
</html>

</body>
</html>
